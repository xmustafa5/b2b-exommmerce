{"openapi":"3.0.0","info":{"title":"Lilium B2B E-commerce API","description":"Complete API documentation for Lilium B2B multi-vendor platform with cash-on-delivery system","version":"1.0.0"},"components":{"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}},"schemas":{}},"paths":{"/api/health/":{"get":{"tags":["Health"],"description":"Health check endpoint","responses":{"200":{"description":"Service is healthy","content":{"application/json":{"schema":{"description":"Service is healthy","type":"object","properties":{"status":{"type":"string"},"timestamp":{"type":"string"},"uptime":{"type":"number"},"database":{"type":"string"}}}}}}}}},"/api/users/":{"get":{"tags":["Users"],"description":"Get all users","parameters":[{"schema":{"type":"string"},"in":"header","name":"authorization","required":true}],"responses":{"200":{"description":"List of users","content":{"application/json":{"schema":{"description":"List of users","type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"name":{"type":"string"},"createdAt":{"type":"string"},"updatedAt":{"type":"string"}}}}}}}}}},"/api/users/{id}":{"get":{"tags":["Users"],"description":"Get user by ID","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true},{"schema":{"type":"string"},"in":"header","name":"authorization","required":true}],"responses":{"200":{"description":"User details","content":{"application/json":{"schema":{"description":"User details","type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"name":{"type":"string"},"createdAt":{"type":"string"},"updatedAt":{"type":"string"}}}}}},"404":{"description":"User not found","content":{"application/json":{"schema":{"description":"User not found","type":"object","properties":{"error":{"type":"string"}}}}}}}},"put":{"tags":["Users"],"description":"Update user","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string","minLength":2},"email":{"type":"string","format":"email"}}}}}},"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true},{"schema":{"type":"string"},"in":"header","name":"authorization","required":true}],"responses":{"200":{"description":"Updated user","content":{"application/json":{"schema":{"description":"Updated user","type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"name":{"type":"string"},"updatedAt":{"type":"string"}}}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"description":"Forbidden","type":"object","properties":{"error":{"type":"string"}}}}}}}},"delete":{"tags":["Users"],"description":"Delete user","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true},{"schema":{"type":"string"},"in":"header","name":"authorization","required":true}],"responses":{"204":{"description":"User deleted successfully"},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"description":"Forbidden","type":"object","properties":{"error":{"type":"string"}}}}}}}}},"/api/auth/login/dashboard":{"post":{"summary":"Dashboard login for vendors and admins","tags":["auth"],"description":"Login endpoint for VENDOR, COMPANY_MANAGER, ADMIN, and SUPER_ADMIN roles","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string","format":"email"},"password":{"type":"string","minLength":6}}}}},"required":true},"responses":{"200":{"description":"Successful login","content":{"application/json":{"schema":{"description":"Successful login","type":"object","properties":{"user":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"name":{"type":"string"},"role":{"type":"string"},"companyId":{"type":"string","nullable":true}}},"tokens":{"type":"object","properties":{"accessToken":{"type":"string"},"refreshToken":{"type":"string"}}}}}}}},"401":{"description":"Invalid credentials or unauthorized role","content":{"application/json":{"schema":{"description":"Invalid credentials or unauthorized role","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/auth/login/mobile":{"post":{"summary":"Mobile login for shop owners","tags":["auth"],"description":"Login endpoint for SHOP_OWNER role only","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string","format":"email"},"password":{"type":"string","minLength":6}}}}},"required":true},"responses":{"200":{"description":"Successful login","content":{"application/json":{"schema":{"description":"Successful login","type":"object","properties":{"user":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"name":{"type":"string"},"businessName":{"type":"string","nullable":true},"phone":{"type":"string","nullable":true},"role":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}}}},"tokens":{"type":"object","properties":{"accessToken":{"type":"string"},"refreshToken":{"type":"string"}}}}}}}},"401":{"description":"Invalid credentials or unauthorized role","content":{"application/json":{"schema":{"description":"Invalid credentials or unauthorized role","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/auth/me":{"get":{"summary":"Get current user profile","tags":["auth"],"description":"Returns the profile of the authenticated user","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"User profile","content":{"application/json":{"schema":{"description":"User profile","type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"name":{"type":"string"},"businessName":{"type":"string","nullable":true},"role":{"type":"string"},"zones":{"type":"array","items":{"type":"string"},"nullable":true}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"description":"Unauthorized","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/auth/logout":{"post":{"summary":"Logout user","tags":["auth"],"description":"Invalidates the current user session","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Successfully logged out","content":{"application/json":{"schema":{"description":"Successfully logged out","type":"object","properties":{"message":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"}}}}}}}}},"/api/auth/refresh":{"post":{"summary":"Refresh access token","tags":["auth"],"description":"Generate new access token using refresh token","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["refreshToken"],"properties":{"refreshToken":{"type":"string"}}}}},"required":true},"responses":{"200":{"description":"New tokens","content":{"application/json":{"schema":{"description":"New tokens","type":"object","properties":{"accessToken":{"type":"string"},"refreshToken":{"type":"string"}}}}}},"401":{"description":"Invalid refresh token","content":{"application/json":{"schema":{"description":"Invalid refresh token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/auth/password/request-reset":{"post":{"summary":"Request password reset","tags":["auth"],"description":"Send password reset email to user","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["email"],"properties":{"email":{"type":"string","format":"email"}}}}},"required":true},"responses":{"200":{"description":"Request processed","content":{"application/json":{"schema":{"description":"Request processed","type":"object","properties":{"message":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"}}}}}}}}},"/api/auth/password/reset":{"post":{"summary":"Reset password","tags":["auth"],"description":"Reset password using token from email","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["token","newPassword"],"properties":{"token":{"type":"string"},"newPassword":{"type":"string","minLength":6}}}}},"required":true},"responses":{"200":{"description":"Password reset successful","content":{"application/json":{"schema":{"description":"Password reset successful","type":"object","properties":{"message":{"type":"string"}}}}}},"400":{"description":"Invalid or expired token","content":{"application/json":{"schema":{"description":"Invalid or expired token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/auth/password":{"put":{"summary":"Update password","tags":["auth"],"description":"Change password for authenticated user","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["currentPassword","newPassword"],"properties":{"currentPassword":{"type":"string","minLength":6},"newPassword":{"type":"string","minLength":6}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Password updated successfully","content":{"application/json":{"schema":{"description":"Password updated successfully","type":"object","properties":{"message":{"type":"string"}}}}}},"400":{"description":"Invalid current password","content":{"application/json":{"schema":{"description":"Invalid current password","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/products/":{"get":{"summary":"Get all products","tags":["products"],"description":"Retrieve a paginated list of products with optional filters. Products are filtered by zones and can be searched by name or filtered by category, price range, and stock availability.","parameters":[{"schema":{"type":"number","minimum":1,"default":1},"in":"query","name":"page","required":false,"description":"Page number for pagination"},{"schema":{"type":"number","minimum":1,"maximum":100,"default":20},"in":"query","name":"limit","required":false,"description":"Number of items per page"},{"schema":{"type":"string","format":"uuid"},"in":"query","name":"categoryId","required":false,"description":"Filter by category ID"},{"schema":{"type":"number","minimum":0},"in":"query","name":"minPrice","required":false,"description":"Minimum price filter"},{"schema":{"type":"number","minimum":0},"in":"query","name":"maxPrice","required":false,"description":"Maximum price filter"},{"schema":{"type":"boolean"},"in":"query","name":"inStock","required":false,"description":"Filter to show only in-stock products"},{"schema":{"type":"string"},"in":"query","name":"search","required":false,"description":"Search by product name (Arabic or English)"},{"schema":{"type":"string","enum":["createdAt","price","nameEn","nameAr","stock"],"default":"createdAt"},"in":"query","name":"sortBy","required":false,"description":"Field to sort by"},{"schema":{"type":"string","enum":["asc","desc"],"default":"desc"},"in":"query","name":"sortOrder","required":false,"description":"Sort order"},{"schema":{"type":"string"},"in":"query","name":"zones","required":false,"description":"Comma-separated list of zones, e.g. KARKH,RUSAFA"}],"responses":{"200":{"description":"Paginated list of products","content":{"application/json":{"schema":{"description":"Paginated list of products","type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"number"},"minOrderQty":{"type":"number"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"number"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}},"pagination":{"type":"object","properties":{"total":{"type":"number"},"page":{"type":"number"},"limit":{"type":"number"},"totalPages":{"type":"number"}}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}},"post":{"summary":"Create new product","tags":["products"],"description":"Create a new product. Only accessible by SUPER_ADMIN and LOCATION_ADMIN roles.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["sku","nameAr","nameEn","price","categoryId","companyId","zones"],"properties":{"sku":{"type":"string","description":"Unique product SKU/code"},"nameAr":{"type":"string","minLength":2,"description":"Product name in Arabic"},"nameEn":{"type":"string","minLength":2,"description":"Product name in English"},"descriptionAr":{"type":"string","nullable":true,"description":"Product description in Arabic"},"descriptionEn":{"type":"string","nullable":true,"description":"Product description in English"},"price":{"type":"number","minimum":0,"description":"Product price"},"compareAtPrice":{"type":"number","minimum":0,"nullable":true,"description":"Original price before discount"},"cost":{"type":"number","minimum":0,"nullable":true,"description":"Cost price for profit calculation"},"stock":{"type":"number","minimum":0,"default":0,"description":"Available stock quantity"},"minOrderQty":{"type":"number","minimum":1,"default":1,"description":"Minimum order quantity"},"unit":{"type":"string","default":"piece","description":"Unit of measurement (piece, box, carton, etc.)"},"images":{"type":"array","items":{"type":"string","format":"uri"},"description":"Array of image URLs"},"categoryId":{"type":"string","format":"uuid","description":"Category ID"},"companyId":{"type":"string","format":"uuid","description":"Company/Vendor ID"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"minItems":1,"description":"Available zones for this product"},"isActive":{"type":"boolean","default":true,"description":"Product active status"},"isFeatured":{"type":"boolean","default":false,"description":"Whether product is featured"},"sortOrder":{"type":"number","default":0,"description":"Display order for sorting"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"201":{"description":"Product created successfully","content":{"application/json":{"schema":{"description":"Product created successfully","type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"number"},"minOrderQty":{"type":"number"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"number"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}}}},"400":{"description":"Bad request - validation error","content":{"application/json":{"schema":{"description":"Bad request - validation error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/products/featured":{"get":{"summary":"Get featured products","tags":["products"],"description":"Retrieve all featured products, optionally filtered by zones. Featured products are highlighted products set by administrators.","parameters":[{"schema":{"type":"string"},"in":"query","name":"zones","required":false,"description":"Comma-separated list of zones, e.g. KARKH,RUSAFA"}],"responses":{"200":{"description":"List of featured products","content":{"application/json":{"schema":{"description":"List of featured products","type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"stock":{"type":"number"},"minOrderQty":{"type":"number"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isFeatured":{"type":"boolean"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/products/category/{categoryId}":{"get":{"summary":"Get products by category","tags":["products"],"description":"Retrieve all products belonging to a specific category, optionally filtered by zones.","parameters":[{"schema":{"type":"string"},"in":"query","name":"zones","required":false,"description":"Comma-separated list of zones, e.g. KARKH,RUSAFA"},{"schema":{"type":"string","format":"uuid"},"in":"path","name":"categoryId","required":true,"description":"Category ID to filter products"}],"responses":{"200":{"description":"List of products in the category","content":{"application/json":{"schema":{"description":"List of products in the category","type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"stock":{"type":"number"},"minOrderQty":{"type":"number"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/products/{id}":{"get":{"summary":"Get product by ID","tags":["products"],"description":"Retrieve detailed information about a specific product by its ID.","parameters":[{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true,"description":"Product ID"}],"responses":{"200":{"description":"Product details","content":{"application/json":{"schema":{"description":"Product details","type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"number"},"minOrderQty":{"type":"number"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"number"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}}}},"404":{"description":"Product not found","content":{"application/json":{"schema":{"description":"Product not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}},"put":{"summary":"Update product","tags":["products"],"description":"Update an existing product. All fields are optional. Only accessible by SUPER_ADMIN and LOCATION_ADMIN roles.","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"sku":{"type":"string","description":"Unique product SKU/code"},"nameAr":{"type":"string","minLength":2,"description":"Product name in Arabic"},"nameEn":{"type":"string","minLength":2,"description":"Product name in English"},"descriptionAr":{"type":"string","nullable":true,"description":"Product description in Arabic"},"descriptionEn":{"type":"string","nullable":true,"description":"Product description in English"},"price":{"type":"number","minimum":0,"description":"Product price"},"compareAtPrice":{"type":"number","minimum":0,"nullable":true,"description":"Original price before discount"},"cost":{"type":"number","minimum":0,"nullable":true,"description":"Cost price for profit calculation"},"stock":{"type":"number","minimum":0,"description":"Available stock quantity"},"minOrderQty":{"type":"number","minimum":1,"description":"Minimum order quantity"},"unit":{"type":"string","description":"Unit of measurement (piece, box, carton, etc.)"},"images":{"type":"array","items":{"type":"string","format":"uri"},"description":"Array of image URLs"},"categoryId":{"type":"string","format":"uuid","description":"Category ID"},"companyId":{"type":"string","format":"uuid","description":"Company/Vendor ID"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"description":"Available zones for this product"},"isActive":{"type":"boolean","description":"Product active status"},"isFeatured":{"type":"boolean","description":"Whether product is featured"},"sortOrder":{"type":"number","description":"Display order for sorting"}}}}}},"parameters":[{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true,"description":"Product ID to update"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Product updated successfully","content":{"application/json":{"schema":{"description":"Product updated successfully","type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"number"},"minOrderQty":{"type":"number"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"number"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}}}},"400":{"description":"Bad request - validation error","content":{"application/json":{"schema":{"description":"Bad request - validation error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Product not found","content":{"application/json":{"schema":{"description":"Product not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}},"delete":{"summary":"Delete product","tags":["products"],"description":"Permanently delete a product. Only accessible by SUPER_ADMIN role.","parameters":[{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true,"description":"Product ID to delete"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Product deleted successfully","content":{"application/json":{"schema":{"description":"Product deleted successfully","type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Product not found","content":{"application/json":{"schema":{"description":"Product not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/products/{id}/stock":{"patch":{"summary":"Update product stock","tags":["products"],"description":"Update product stock quantity by adding, subtracting, or setting a specific value. Only accessible by SUPER_ADMIN and LOCATION_ADMIN roles.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["quantity","operation"],"properties":{"quantity":{"type":"number","minimum":0,"description":"Stock quantity to add, subtract, or set"},"operation":{"type":"string","enum":["add","subtract","set"],"description":"Operation to perform: add (increase stock), subtract (decrease stock), or set (replace stock)"}}}}},"required":true},"parameters":[{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true,"description":"Product ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Stock updated successfully","content":{"application/json":{"schema":{"description":"Stock updated successfully","type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"stock":{"type":"number"},"updatedAt":{"type":"string","format":"date-time"}}}}}},"400":{"description":"Bad request - validation error or insufficient stock","content":{"application/json":{"schema":{"description":"Bad request - validation error or insufficient stock","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Product not found","content":{"application/json":{"schema":{"description":"Product not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/products/bulk":{"patch":{"summary":"Bulk update products","tags":["products"],"description":"Update multiple products at once with the same data. Only accessible by SUPER_ADMIN and LOCATION_ADMIN roles.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["ids","data"],"properties":{"ids":{"type":"array","items":{"type":"string","format":"uuid"},"minItems":1,"description":"Array of product IDs to update"},"data":{"type":"object","description":"Data to apply to all selected products","properties":{"nameAr":{"type":"string","minLength":2},"nameEn":{"type":"string","minLength":2},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number","minimum":0},"compareAtPrice":{"type":"number","minimum":0,"nullable":true},"cost":{"type":"number","minimum":0,"nullable":true},"stock":{"type":"number","minimum":0},"minOrderQty":{"type":"number","minimum":1},"unit":{"type":"string"},"categoryId":{"type":"string","format":"uuid"},"companyId":{"type":"string","format":"uuid"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"number"}}}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Products updated successfully","content":{"application/json":{"schema":{"description":"Products updated successfully","type":"object","properties":{"message":{"type":"string"},"products":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"price":{"type":"number"},"stock":{"type":"number"},"updatedAt":{"type":"string","format":"date-time"}}}}}}}}},"400":{"description":"Bad request - validation error","content":{"application/json":{"schema":{"description":"Bad request - validation error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}},"delete":{"summary":"Bulk delete products","tags":["products"],"description":"Permanently delete multiple products at once. Only accessible by SUPER_ADMIN role.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["ids"],"properties":{"ids":{"type":"array","items":{"type":"string","format":"uuid"},"minItems":1,"description":"Array of product IDs to delete"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Products deleted successfully","content":{"application/json":{"schema":{"description":"Products deleted successfully","type":"object","properties":{"message":{"type":"string"}}}}}},"400":{"description":"Bad request - validation error","content":{"application/json":{"schema":{"description":"Bad request - validation error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/categories/":{"get":{"summary":"Get all categories","tags":["categories"],"description":"Retrieve all categories with optional filtering for inactive ones","parameters":[{"schema":{"type":"string","enum":["true","false"],"default":"false"},"in":"query","name":"includeInactive","required":false,"description":"Include inactive categories in the response"}],"responses":{"200":{"description":"Categories retrieved successfully","content":{"application/json":{"schema":{"description":"Categories retrieved successfully","type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"number"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"children":{"type":"array","items":{"type":"object"}},"productCount":{"type":"number"}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}},"post":{"summary":"Create a new category","tags":["categories"],"description":"Create a new category (Admin only)","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["nameAr","nameEn"],"properties":{"nameAr":{"type":"string","minLength":2,"description":"Category name in Arabic"},"nameEn":{"type":"string","minLength":2,"description":"Category name in English"},"description":{"type":"string","nullable":true,"description":"Category description"},"image":{"type":"string","nullable":true,"description":"Category image URL"},"parentId":{"type":"string","nullable":true,"description":"Parent category ID for subcategories"},"isActive":{"type":"boolean","default":true,"description":"Category active status"},"displayOrder":{"type":"number","default":0,"description":"Display order for sorting"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"201":{"description":"Category created successfully","content":{"application/json":{"schema":{"description":"Category created successfully","type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"number"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}}}},"400":{"description":"Bad request - Invalid input","content":{"application/json":{"schema":{"description":"Bad request - Invalid input","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"description":"Unauthorized","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/categories/stats":{"get":{"summary":"Get category statistics","tags":["categories"],"description":"Retrieve statistics for all categories (Admin only)","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Category statistics","content":{"application/json":{"schema":{"description":"Category statistics","type":"object","properties":{"totalCategories":{"type":"number"},"activeCategories":{"type":"number"},"inactiveCategories":{"type":"number"},"parentCategories":{"type":"number"},"childCategories":{"type":"number"},"categoriesWithProducts":{"type":"number"},"topCategories":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"productCount":{"type":"number"}}}}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"description":"Unauthorized","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/categories/{id}":{"get":{"summary":"Get category by ID","tags":["categories"],"description":"Retrieve a single category by its ID","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Category ID"}],"responses":{"200":{"description":"Category retrieved successfully","content":{"application/json":{"schema":{"description":"Category retrieved successfully","type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"number"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"parent":{"type":"object","nullable":true,"properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"}}},"children":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"isActive":{"type":"boolean"},"displayOrder":{"type":"number"}}}},"productCount":{"type":"number"}}}}}},"404":{"description":"Category not found","content":{"application/json":{"schema":{"description":"Category not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}},"put":{"summary":"Update a category","tags":["categories"],"description":"Update an existing category (Admin only)","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"nameAr":{"type":"string","minLength":2,"description":"Category name in Arabic"},"nameEn":{"type":"string","minLength":2,"description":"Category name in English"},"description":{"type":"string","nullable":true,"description":"Category description"},"image":{"type":"string","nullable":true,"description":"Category image URL"},"parentId":{"type":"string","nullable":true,"description":"Parent category ID for subcategories"},"isActive":{"type":"boolean","description":"Category active status"},"displayOrder":{"type":"number","description":"Display order for sorting"}}}}}},"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Category ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Category updated successfully","content":{"application/json":{"schema":{"description":"Category updated successfully","type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"number"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}}}},"400":{"description":"Bad request - Invalid input","content":{"application/json":{"schema":{"description":"Bad request - Invalid input","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"description":"Unauthorized","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Category not found","content":{"application/json":{"schema":{"description":"Category not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}},"delete":{"summary":"Delete a category","tags":["categories"],"description":"Delete a category. If category has products, must provide reassignToId to reassign products to another category (Super Admin only)","parameters":[{"schema":{"type":"string"},"in":"query","name":"reassignToId","required":false,"description":"Category ID to reassign products to (required if category has products)"},{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Category ID to delete"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Category deleted successfully","content":{"application/json":{"schema":{"description":"Category deleted successfully","type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"},"deletedCategory":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"}}},"reassignedProductsCount":{"type":"number"}}}}}},"400":{"description":"Bad request - Cannot delete category with products without reassignToId","content":{"application/json":{"schema":{"description":"Bad request - Cannot delete category with products without reassignToId","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"description":"Unauthorized","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Super Admin only","content":{"application/json":{"schema":{"description":"Forbidden - Super Admin only","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Category not found","content":{"application/json":{"schema":{"description":"Category not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/categories/reorder":{"patch":{"summary":"Reorder categories","tags":["categories"],"description":"Update display order for multiple categories (Admin only)","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["categories"],"properties":{"categories":{"type":"array","items":{"type":"object","required":["id","displayOrder"],"properties":{"id":{"type":"string","description":"Category ID"},"displayOrder":{"type":"number","description":"New display order"}}},"description":"Array of category IDs with new display orders"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Categories reordered successfully","content":{"application/json":{"schema":{"description":"Categories reordered successfully","type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"},"updatedCount":{"type":"number"}}}}}},"400":{"description":"Bad request - Invalid input","content":{"application/json":{"schema":{"description":"Bad request - Invalid input","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"description":"Unauthorized","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/upload/single":{"post":{"summary":"Upload a single file","tags":["upload"],"description":"Upload a single file (image). Supported formats: JPEG, PNG, WebP, GIF. Maximum file size: 5MB. Only accessible by SUPER_ADMIN and LOCATION_ADMIN roles.","requestBody":{"content":{"multipart/form-data":{"schema":{"type":"object","required":["file"],"properties":{"file":{"type":"string","format":"binary","description":"The file to upload. Supported formats: image/jpeg, image/png, image/webp, image/gif. Maximum size: 5MB."}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"File uploaded successfully","content":{"application/json":{"schema":{"description":"File uploaded successfully","type":"object","properties":{"success":{"type":"boolean"},"url":{"type":"string","description":"Public URL of the uploaded file, e.g. /uploads/abc123-def456.jpg"},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - No file provided, invalid file type, or file size exceeded","content":{"application/json":{"schema":{"description":"Bad request - No file provided, invalid file type, or file size exceeded","type":"object","properties":{"error":{"type":"string","description":"Error message describing the issue"}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/upload/multiple":{"post":{"summary":"Upload multiple files","tags":["upload"],"description":"Upload multiple files (images) at once. Supported formats: JPEG, PNG, WebP, GIF. Maximum file size per file: 5MB. Only accessible by SUPER_ADMIN and LOCATION_ADMIN roles.","requestBody":{"content":{"multipart/form-data":{"schema":{"type":"object","required":["files"],"properties":{"files":{"type":"array","items":{"type":"string","format":"binary"},"description":"Array of files to upload. Supported formats: image/jpeg, image/png, image/webp, image/gif. Maximum size per file: 5MB."}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Files uploaded successfully","content":{"application/json":{"schema":{"description":"Files uploaded successfully","type":"object","properties":{"success":{"type":"boolean"},"urls":{"type":"array","items":{"type":"string"},"description":"Array of public URLs for uploaded files"},"count":{"type":"number","description":"Number of files uploaded"},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - No files provided, invalid file type, or file size exceeded","content":{"application/json":{"schema":{"description":"Bad request - No files provided, invalid file type, or file size exceeded","type":"object","properties":{"error":{"type":"string","description":"Error message describing the issue"}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/upload/{filename}":{"delete":{"summary":"Delete a file","tags":["upload"],"description":"Delete a previously uploaded file by its filename. Only accessible by SUPER_ADMIN and LOCATION_ADMIN roles.","parameters":[{"schema":{"type":"string"},"in":"path","name":"filename","required":true,"description":"The filename of the file to delete (including extension), e.g. abc123-def456.jpg"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"File deleted successfully","content":{"application/json":{"schema":{"description":"File deleted successfully","type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"500":{"description":"Internal server error - File deletion failed","content":{"application/json":{"schema":{"description":"Internal server error - File deletion failed","type":"object","properties":{"error":{"type":"string","description":"Error message describing the issue"}}}}}}}}},"/api/orders/":{"get":{"summary":"Get all orders with filters","tags":["orders"],"description":"Retrieve orders with pagination and filters. Shop owners see only their orders, admins see orders based on their permissions.","parameters":[{"schema":{"type":"integer","minimum":1,"default":1},"in":"query","name":"page","required":false,"description":"Page number"},{"schema":{"type":"integer","minimum":1,"maximum":100,"default":20},"in":"query","name":"limit","required":false,"description":"Items per page"},{"schema":{"type":"string","enum":["PENDING","CONFIRMED","PROCESSING","SHIPPED","DELIVERED","CANCELLED","REFUNDED"]},"in":"query","name":"status","required":false,"description":"Filter by order status"},{"schema":{"type":"string","enum":["KARKH","RUSAFA"]},"in":"query","name":"zone","required":false,"description":"Filter by zone"},{"schema":{"type":"string","format":"date-time"},"in":"query","name":"startDate","required":false,"description":"Filter orders from this date"},{"schema":{"type":"string","format":"date-time"},"in":"query","name":"endDate","required":false,"description":"Filter orders until this date"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"List of orders with pagination","content":{"application/json":{"schema":{"description":"List of orders with pagination","type":"object","properties":{"orders":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"orderNumber":{"type":"string"},"userId":{"type":"string"},"status":{"type":"string"},"subtotal":{"type":"number"},"discount":{"type":"number"},"deliveryFee":{"type":"number"},"total":{"type":"number"},"zone":{"type":"string"},"paymentMethod":{"type":"string","nullable":true},"paymentStatus":{"type":"string","nullable":true},"notes":{"type":"string","nullable":true},"deliveryDate":{"type":"string","format":"date-time","nullable":true},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}},"pagination":{"type":"object","properties":{"page":{"type":"integer"},"limit":{"type":"integer"},"total":{"type":"integer"},"totalPages":{"type":"integer"}}}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"description":"Unauthorized","type":"object","properties":{"error":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"}}}}}}}},"post":{"summary":"Create a new order","tags":["orders"],"description":"Create a new order. Only shop owners can create orders.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["addressId","companyId","items","zone"],"properties":{"addressId":{"type":"string","description":"Delivery address ID"},"companyId":{"type":"string","description":"Company/vendor ID for this order"},"zone":{"type":"string","enum":["KARKH","RUSAFA"],"description":"Delivery zone"},"items":{"type":"array","minItems":1,"items":{"type":"object","required":["productId","quantity"],"properties":{"productId":{"type":"string","description":"Product ID"},"quantity":{"type":"integer","minimum":1,"description":"Quantity to order"}}},"description":"Array of order items"},"notes":{"type":"string","maxLength":500,"description":"Order notes or special instructions"},"promotionId":{"type":"string","description":"Promotion code to apply"},"paymentMethod":{"type":"string","enum":["cash","card","bank_transfer"],"description":"Payment method"},"deliveryDate":{"type":"string","format":"date-time","description":"Preferred delivery date"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"201":{"description":"Order created successfully","content":{"application/json":{"schema":{"description":"Order created successfully","type":"object","properties":{"id":{"type":"string"},"orderNumber":{"type":"string"},"userId":{"type":"string"},"addressId":{"type":"string"},"companyId":{"type":"string"},"status":{"type":"string"},"subtotal":{"type":"number"},"discount":{"type":"number"},"deliveryFee":{"type":"number"},"total":{"type":"number"},"notes":{"type":"string","nullable":true},"zone":{"type":"string"},"paymentMethod":{"type":"string","nullable":true},"paymentStatus":{"type":"string"},"deliveryDate":{"type":"string","format":"date-time","nullable":true},"createdAt":{"type":"string","format":"date-time"},"items":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"productId":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"price":{"type":"number"},"quantity":{"type":"integer"},"discount":{"type":"number"},"total":{"type":"number"}}}}}}}}},"400":{"description":"Bad request - Invalid data or out of stock","content":{"application/json":{"schema":{"description":"Bad request - Invalid data or out of stock","type":"object","properties":{"error":{"type":"string"}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"description":"Unauthorized","type":"object","properties":{"error":{"type":"string"}}}}}},"403":{"description":"Forbidden - Only shop owners can create orders","content":{"application/json":{"schema":{"description":"Forbidden - Only shop owners can create orders","type":"object","properties":{"error":{"type":"string"}}}}}}}}},"/api/orders/stats":{"get":{"summary":"Get order statistics","tags":["orders"],"description":"Retrieve order statistics for admins. Location admins can only see stats for their zones.","parameters":[{"schema":{"type":"string","enum":["KARKH","RUSAFA"]},"in":"query","name":"zone","required":false,"description":"Filter statistics by zone"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Order statistics","content":{"application/json":{"schema":{"description":"Order statistics","type":"object","properties":{"totalOrders":{"type":"integer","description":"Total number of orders"},"totalRevenue":{"type":"number","description":"Total revenue from all orders"},"averageOrderValue":{"type":"number","description":"Average order value"},"ordersByStatus":{"type":"object","properties":{"PENDING":{"type":"integer"},"CONFIRMED":{"type":"integer"},"PROCESSING":{"type":"integer"},"SHIPPED":{"type":"integer"},"DELIVERED":{"type":"integer"},"CANCELLED":{"type":"integer"},"REFUNDED":{"type":"integer"}}},"ordersByZone":{"type":"object","properties":{"KARKH":{"type":"integer"},"RUSAFA":{"type":"integer"}}}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"description":"Unauthorized","type":"object","properties":{"error":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"}}}}}}}}},"/api/orders/{id}":{"get":{"summary":"Get order by ID","tags":["orders"],"description":"Retrieve a single order with all details including items and status history. Shop owners can only access their own orders.","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Order ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Order details","content":{"application/json":{"schema":{"description":"Order details","type":"object","properties":{"id":{"type":"string"},"orderNumber":{"type":"string"},"userId":{"type":"string"},"addressId":{"type":"string"},"companyId":{"type":"string"},"status":{"type":"string","enum":["PENDING","CONFIRMED","PROCESSING","SHIPPED","DELIVERED","CANCELLED","REFUNDED"]},"subtotal":{"type":"number"},"discount":{"type":"number"},"deliveryFee":{"type":"number"},"total":{"type":"number"},"notes":{"type":"string","nullable":true},"promotionId":{"type":"string","nullable":true},"zone":{"type":"string","enum":["KARKH","RUSAFA"]},"paymentMethod":{"type":"string","nullable":true},"paymentStatus":{"type":"string","nullable":true},"deliveryDate":{"type":"string","format":"date-time","nullable":true},"deliveredAt":{"type":"string","format":"date-time","nullable":true},"cancelledAt":{"type":"string","format":"date-time","nullable":true},"cancelReason":{"type":"string","nullable":true},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"items":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"productId":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"price":{"type":"number"},"quantity":{"type":"integer"},"discount":{"type":"number"},"total":{"type":"number"},"createdAt":{"type":"string","format":"date-time"}}}},"statusHistory":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"fromStatus":{"type":"string","nullable":true},"toStatus":{"type":"string"},"comment":{"type":"string","nullable":true},"createdBy":{"type":"string","nullable":true},"createdAt":{"type":"string","format":"date-time"}}}},"user":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"email":{"type":"string"},"phone":{"type":"string","nullable":true}}},"address":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"street":{"type":"string"},"area":{"type":"string"},"zone":{"type":"string"},"phone":{"type":"string"}}}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"description":"Unauthorized","type":"object","properties":{"error":{"type":"string"}}}}}},"404":{"description":"Order not found","content":{"application/json":{"schema":{"description":"Order not found","type":"object","properties":{"error":{"type":"string"}}}}}}}},"delete":{"summary":"Cancel an order","tags":["orders"],"description":"Cancel an order. Shop owners can cancel their own orders if not yet shipped. Admins can cancel any order.","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Order ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Order cancelled successfully","content":{"application/json":{"schema":{"description":"Order cancelled successfully","type":"object","properties":{"id":{"type":"string"},"orderNumber":{"type":"string"},"status":{"type":"string"},"cancelledAt":{"type":"string","format":"date-time"},"cancelReason":{"type":"string","nullable":true},"updatedAt":{"type":"string","format":"date-time"},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - Order cannot be cancelled (already shipped or delivered)","content":{"application/json":{"schema":{"description":"Bad request - Order cannot be cancelled (already shipped or delivered)","type":"object","properties":{"error":{"type":"string"}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"description":"Unauthorized","type":"object","properties":{"error":{"type":"string"}}}}}},"403":{"description":"Forbidden - Cannot cancel orders of other users","content":{"application/json":{"schema":{"description":"Forbidden - Cannot cancel orders of other users","type":"object","properties":{"error":{"type":"string"}}}}}},"404":{"description":"Order not found","content":{"application/json":{"schema":{"description":"Order not found","type":"object","properties":{"error":{"type":"string"}}}}}}}}},"/api/orders/{id}/status":{"put":{"summary":"Update order status","tags":["orders"],"description":"Update the status of an order. Only admins can perform this action. Status changes are tracked in status history.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["status"],"properties":{"status":{"type":"string","enum":["PENDING","CONFIRMED","PROCESSING","SHIPPED","DELIVERED","CANCELLED","REFUNDED"],"description":"New order status"},"note":{"type":"string","maxLength":500,"description":"Optional note about the status change"}}}}},"required":true},"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Order ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Order status updated successfully","content":{"application/json":{"schema":{"description":"Order status updated successfully","type":"object","properties":{"id":{"type":"string"},"orderNumber":{"type":"string"},"status":{"type":"string"},"updatedAt":{"type":"string","format":"date-time"},"statusHistory":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"fromStatus":{"type":"string","nullable":true},"toStatus":{"type":"string"},"comment":{"type":"string","nullable":true},"createdBy":{"type":"string","nullable":true},"createdAt":{"type":"string","format":"date-time"}}}}}}}}},"400":{"description":"Bad request - Invalid status transition","content":{"application/json":{"schema":{"description":"Bad request - Invalid status transition","type":"object","properties":{"error":{"type":"string"}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"description":"Unauthorized","type":"object","properties":{"error":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"}}}}}},"404":{"description":"Order not found","content":{"application/json":{"schema":{"description":"Order not found","type":"object","properties":{"error":{"type":"string"}}}}}}}}},"/api/promotions/":{"get":{"summary":"Get all promotions","tags":["promotions"],"description":"Retrieve a list of all promotions. By default, only active and non-expired promotions are returned. Use includeInactive=true to retrieve all promotions including inactive ones.","parameters":[{"schema":{"type":"string","enum":["true","false"],"default":"false"},"in":"query","name":"includeInactive","required":false,"description":"Set to \"true\" to include inactive and expired promotions"}],"responses":{"200":{"description":"List of promotions","content":{"application/json":{"schema":{"description":"List of promotions","type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"type":{"type":"string","enum":["percentage","fixed","buy_x_get_y","bundle"]},"value":{"type":"number"},"minPurchase":{"type":"number","nullable":true},"maxDiscount":{"type":"number","nullable":true},"buyQuantity":{"type":"integer","nullable":true},"getQuantity":{"type":"integer","nullable":true},"startDate":{"type":"string","format":"date-time"},"endDate":{"type":"string","format":"date-time"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]}},"isActive":{"type":"boolean"},"usageLimit":{"type":"integer","nullable":true},"usageCount":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"products":{"type":"array","items":{"type":"object","properties":{"productId":{"type":"string"},"promotionId":{"type":"string"},"product":{"type":"object","properties":{"id":{"type":"string"},"nameEn":{"type":"string"},"nameAr":{"type":"string"},"sku":{"type":"string"},"price":{"type":"number"},"images":{"type":"array","items":{"type":"string"}}}}}}},"categories":{"type":"array","items":{"type":"object","properties":{"categoryId":{"type":"string"},"promotionId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameEn":{"type":"string"},"nameAr":{"type":"string"},"slug":{"type":"string"}}}}}}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}},"post":{"summary":"Create new promotion","tags":["promotions"],"description":"Create a new promotion with specified discount type, value, and validity period. Only accessible by SUPER_ADMIN and LOCATION_ADMIN roles.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["nameEn","nameAr","type","value","startDate","endDate","zones"],"properties":{"nameEn":{"type":"string","minLength":2,"description":"Promotion name in English"},"nameAr":{"type":"string","minLength":2,"description":"Promotion name in Arabic"},"descriptionEn":{"type":"string","nullable":true,"description":"Promotion description in English"},"descriptionAr":{"type":"string","nullable":true,"description":"Promotion description in Arabic"},"type":{"type":"string","enum":["percentage","fixed","buy_x_get_y","bundle"],"description":"Type of discount: percentage (% off), fixed (fixed amount off), buy_x_get_y (buy X get Y free), bundle (bundle discount)"},"value":{"type":"number","minimum":0,"description":"Discount value (percentage for percentage type, fixed amount for fixed type)"},"minPurchase":{"type":"number","minimum":0,"nullable":true,"description":"Minimum purchase amount required to apply this promotion"},"maxDiscount":{"type":"number","minimum":0,"nullable":true,"description":"Maximum discount amount (applies to percentage type to cap the discount)"},"buyQuantity":{"type":"integer","minimum":1,"nullable":true,"description":"Number of items to buy (for buy_x_get_y type)"},"getQuantity":{"type":"integer","minimum":1,"nullable":true,"description":"Number of free items to get (for buy_x_get_y type)"},"startDate":{"type":"string","format":"date-time","description":"Promotion start date and time"},"endDate":{"type":"string","format":"date-time","description":"Promotion end date and time"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"minItems":1,"description":"Zones where this promotion is applicable"},"productIds":{"type":"array","items":{"type":"string"},"description":"Array of product IDs this promotion applies to"},"categoryIds":{"type":"array","items":{"type":"string"},"description":"Array of category IDs this promotion applies to"},"isActive":{"type":"boolean","default":true,"description":"Whether the promotion is active"},"usageLimit":{"type":"integer","minimum":1,"nullable":true,"description":"Maximum number of times this promotion can be used"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"201":{"description":"Promotion created successfully","content":{"application/json":{"schema":{"description":"Promotion created successfully","type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"type":{"type":"string","enum":["percentage","fixed","buy_x_get_y","bundle"]},"value":{"type":"number"},"minPurchase":{"type":"number","nullable":true},"maxDiscount":{"type":"number","nullable":true},"buyQuantity":{"type":"integer","nullable":true},"getQuantity":{"type":"integer","nullable":true},"startDate":{"type":"string","format":"date-time"},"endDate":{"type":"string","format":"date-time"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]}},"isActive":{"type":"boolean"},"usageLimit":{"type":"integer","nullable":true},"usageCount":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"products":{"type":"array","items":{"type":"object","properties":{"productId":{"type":"string"},"promotionId":{"type":"string"},"product":{"type":"object","properties":{"id":{"type":"string"},"nameEn":{"type":"string"},"nameAr":{"type":"string"},"sku":{"type":"string"},"price":{"type":"number"},"images":{"type":"array","items":{"type":"string"}}}}}}},"categories":{"type":"array","items":{"type":"object","properties":{"categoryId":{"type":"string"},"promotionId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameEn":{"type":"string"},"nameAr":{"type":"string"},"slug":{"type":"string"}}}}}}}}}}},"400":{"description":"Bad request - validation error or invalid dates","content":{"application/json":{"schema":{"description":"Bad request - validation error or invalid dates","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/promotions/active/{zone}":{"get":{"summary":"Get active promotions by zone","tags":["promotions"],"description":"Retrieve all currently active promotions that apply to a specific zone. Only returns promotions that are active, within their valid date range, and applicable to the specified zone.","parameters":[{"schema":{"type":"string","enum":["KARKH","RUSAFA"]},"in":"path","name":"zone","required":true,"description":"The zone to filter promotions by"}],"responses":{"200":{"description":"List of active promotions for the specified zone","content":{"application/json":{"schema":{"description":"List of active promotions for the specified zone","type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"type":{"type":"string","enum":["percentage","fixed","buy_x_get_y","bundle"]},"value":{"type":"number"},"minPurchase":{"type":"number","nullable":true},"maxDiscount":{"type":"number","nullable":true},"buyQuantity":{"type":"integer","nullable":true},"getQuantity":{"type":"integer","nullable":true},"startDate":{"type":"string","format":"date-time"},"endDate":{"type":"string","format":"date-time"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]}},"isActive":{"type":"boolean"},"usageLimit":{"type":"integer","nullable":true},"usageCount":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"products":{"type":"array","items":{"type":"object","properties":{"productId":{"type":"string"},"promotionId":{"type":"string"},"product":{"type":"object","properties":{"id":{"type":"string"},"nameEn":{"type":"string"},"nameAr":{"type":"string"},"sku":{"type":"string"},"price":{"type":"number"},"images":{"type":"array","items":{"type":"string"}}}}}}},"categories":{"type":"array","items":{"type":"object","properties":{"categoryId":{"type":"string"},"promotionId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameEn":{"type":"string"},"nameAr":{"type":"string"},"slug":{"type":"string"}}}}}}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/promotions/{id}":{"get":{"summary":"Get promotion by ID","tags":["promotions"],"description":"Retrieve detailed information about a specific promotion by its ID, including associated products and categories.","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Promotion ID"}],"responses":{"200":{"description":"Promotion details","content":{"application/json":{"schema":{"description":"Promotion details","type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"type":{"type":"string","enum":["percentage","fixed","buy_x_get_y","bundle"]},"value":{"type":"number"},"minPurchase":{"type":"number","nullable":true},"maxDiscount":{"type":"number","nullable":true},"buyQuantity":{"type":"integer","nullable":true},"getQuantity":{"type":"integer","nullable":true},"startDate":{"type":"string","format":"date-time"},"endDate":{"type":"string","format":"date-time"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]}},"isActive":{"type":"boolean"},"usageLimit":{"type":"integer","nullable":true},"usageCount":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"products":{"type":"array","items":{"type":"object","properties":{"productId":{"type":"string"},"promotionId":{"type":"string"},"product":{"type":"object","properties":{"id":{"type":"string"},"nameEn":{"type":"string"},"nameAr":{"type":"string"},"sku":{"type":"string"},"price":{"type":"number"},"images":{"type":"array","items":{"type":"string"}}}}}}},"categories":{"type":"array","items":{"type":"object","properties":{"categoryId":{"type":"string"},"promotionId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameEn":{"type":"string"},"nameAr":{"type":"string"},"slug":{"type":"string"}}}}}}}}}}},"404":{"description":"Promotion not found","content":{"application/json":{"schema":{"description":"Promotion not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}},"put":{"summary":"Update promotion","tags":["promotions"],"description":"Update an existing promotion. All fields are optional. Only accessible by SUPER_ADMIN and LOCATION_ADMIN roles.","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"nameEn":{"type":"string","minLength":2,"description":"Promotion name in English"},"nameAr":{"type":"string","minLength":2,"description":"Promotion name in Arabic"},"descriptionEn":{"type":"string","nullable":true,"description":"Promotion description in English"},"descriptionAr":{"type":"string","nullable":true,"description":"Promotion description in Arabic"},"type":{"type":"string","enum":["percentage","fixed","buy_x_get_y","bundle"],"description":"Type of discount"},"value":{"type":"number","minimum":0,"description":"Discount value"},"minPurchase":{"type":"number","minimum":0,"nullable":true,"description":"Minimum purchase amount required"},"maxDiscount":{"type":"number","minimum":0,"nullable":true,"description":"Maximum discount amount (for percentage type)"},"buyQuantity":{"type":"integer","minimum":1,"nullable":true,"description":"Number of items to buy (for buy_x_get_y type)"},"getQuantity":{"type":"integer","minimum":1,"nullable":true,"description":"Number of free items to get (for buy_x_get_y type)"},"startDate":{"type":"string","format":"date-time","description":"Promotion start date and time"},"endDate":{"type":"string","format":"date-time","description":"Promotion end date and time"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"description":"Zones where this promotion is applicable"},"productIds":{"type":"array","items":{"type":"string"},"description":"Array of product IDs this promotion applies to (replaces existing products)"},"categoryIds":{"type":"array","items":{"type":"string"},"description":"Array of category IDs this promotion applies to (replaces existing categories)"},"isActive":{"type":"boolean","description":"Whether the promotion is active"},"usageLimit":{"type":"integer","minimum":1,"nullable":true,"description":"Maximum number of times this promotion can be used"}}}}}},"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Promotion ID to update"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Promotion updated successfully","content":{"application/json":{"schema":{"description":"Promotion updated successfully","type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"type":{"type":"string","enum":["percentage","fixed","buy_x_get_y","bundle"]},"value":{"type":"number"},"minPurchase":{"type":"number","nullable":true},"maxDiscount":{"type":"number","nullable":true},"buyQuantity":{"type":"integer","nullable":true},"getQuantity":{"type":"integer","nullable":true},"startDate":{"type":"string","format":"date-time"},"endDate":{"type":"string","format":"date-time"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]}},"isActive":{"type":"boolean"},"usageLimit":{"type":"integer","nullable":true},"usageCount":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"products":{"type":"array","items":{"type":"object","properties":{"productId":{"type":"string"},"promotionId":{"type":"string"},"product":{"type":"object","properties":{"id":{"type":"string"},"nameEn":{"type":"string"},"nameAr":{"type":"string"},"sku":{"type":"string"},"price":{"type":"number"},"images":{"type":"array","items":{"type":"string"}}}}}}},"categories":{"type":"array","items":{"type":"object","properties":{"categoryId":{"type":"string"},"promotionId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameEn":{"type":"string"},"nameAr":{"type":"string"},"slug":{"type":"string"}}}}}}}}}}},"400":{"description":"Bad request - validation error or invalid dates","content":{"application/json":{"schema":{"description":"Bad request - validation error or invalid dates","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Promotion not found","content":{"application/json":{"schema":{"description":"Promotion not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}},"delete":{"summary":"Delete promotion","tags":["promotions"],"description":"Permanently delete a promotion. Only accessible by SUPER_ADMIN role.","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Promotion ID to delete"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Promotion deleted successfully","content":{"application/json":{"schema":{"description":"Promotion deleted successfully","type":"object","properties":{"message":{"type":"string"}}}}}},"400":{"description":"Bad request","content":{"application/json":{"schema":{"description":"Bad request","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Promotion not found","content":{"application/json":{"schema":{"description":"Promotion not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/promotions/{id}/toggle":{"patch":{"summary":"Toggle promotion status","tags":["promotions"],"description":"Toggle the active status of a promotion (activate/deactivate). Only accessible by SUPER_ADMIN and LOCATION_ADMIN roles.","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Promotion ID to toggle"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Promotion status toggled successfully","content":{"application/json":{"schema":{"description":"Promotion status toggled successfully","type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"type":{"type":"string","enum":["percentage","fixed","buy_x_get_y","bundle"]},"value":{"type":"number"},"minPurchase":{"type":"number","nullable":true},"maxDiscount":{"type":"number","nullable":true},"buyQuantity":{"type":"integer","nullable":true},"getQuantity":{"type":"integer","nullable":true},"startDate":{"type":"string","format":"date-time"},"endDate":{"type":"string","format":"date-time"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]}},"isActive":{"type":"boolean"},"usageLimit":{"type":"integer","nullable":true},"usageCount":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}}}},"400":{"description":"Bad request","content":{"application/json":{"schema":{"description":"Bad request","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Promotion not found","content":{"application/json":{"schema":{"description":"Promotion not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/promotions/apply-to-cart":{"post":{"summary":"Apply promotions to cart","tags":["promotions"],"description":"Calculate and apply applicable promotions to cart items. Returns total discount amount and details of applied promotions for each item.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["cartItems"],"properties":{"cartItems":{"type":"array","minItems":1,"description":"Array of cart items to calculate promotions for","items":{"type":"object","required":["productId","quantity","price"],"properties":{"productId":{"type":"string","description":"Product ID"},"quantity":{"type":"integer","minimum":1,"description":"Quantity of the product in cart"},"price":{"type":"number","minimum":0,"description":"Unit price of the product"}}}}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Promotion calculation result","content":{"application/json":{"schema":{"description":"Promotion calculation result","type":"object","properties":{"totalDiscount":{"type":"number","description":"Total discount amount applied to the cart"},"appliedPromotions":{"type":"array","description":"List of promotions applied to cart items","items":{"type":"object","properties":{"productId":{"type":"string","description":"Product ID the promotion was applied to"},"id":{"type":"string","description":"Promotion ID"},"nameEn":{"type":"string","description":"Promotion name in English"},"nameAr":{"type":"string","description":"Promotion name in Arabic"},"type":{"type":"string","enum":["percentage","fixed","buy_x_get_y","bundle"],"description":"Type of discount applied"},"value":{"type":"number","description":"Discount value"},"discountAmount":{"type":"number","description":"Actual discount amount applied to this item"}}}}}}}}},"400":{"description":"Bad request - validation error","content":{"application/json":{"schema":{"description":"Bad request - validation error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/vendors/company":{"get":{"summary":"Get vendor company details","tags":["vendors"],"description":"Retrieves the company details associated with the authenticated vendor user","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Company details retrieved successfully","content":{"application/json":{"schema":{"description":"Company details retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"company":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"nameAr":{"type":"string","nullable":true},"description":{"type":"string","nullable":true},"descriptionAr":{"type":"string","nullable":true},"logo":{"type":"string","nullable":true},"email":{"type":"string","nullable":true},"phone":{"type":"string","nullable":true},"address":{"type":"string","nullable":true},"zones":{"type":"array","items":{"type":"string"}},"commissionRate":{"type":"number","nullable":true},"isActive":{"type":"boolean"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/vendors/company/{id}":{"put":{"summary":"Update vendor company details","tags":["vendors"],"description":"Updates the company details for the authenticated vendor. Vendors can only update their own company.","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string","description":"Company name in English"},"nameAr":{"type":"string","description":"Company name in Arabic"},"description":{"type":"string","description":"Company description in English"},"descriptionAr":{"type":"string","description":"Company description in Arabic"},"logo":{"type":"string","description":"URL to company logo"},"email":{"type":"string","format":"email","description":"Company email address"},"phone":{"type":"string","description":"Company phone number"},"address":{"type":"string","description":"Company physical address"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"description":"Operating zones"},"commissionRate":{"type":"number","minimum":0,"maximum":100,"description":"Commission rate percentage"}}}}}},"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Company ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Company updated successfully","content":{"application/json":{"schema":{"description":"Company updated successfully","type":"object","properties":{"success":{"type":"boolean"},"company":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"nameAr":{"type":"string","nullable":true},"description":{"type":"string","nullable":true},"descriptionAr":{"type":"string","nullable":true},"logo":{"type":"string","nullable":true},"email":{"type":"string","nullable":true},"phone":{"type":"string","nullable":true},"address":{"type":"string","nullable":true},"zones":{"type":"array","items":{"type":"string"}},"commissionRate":{"type":"number","nullable":true},"isActive":{"type":"boolean"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - Invalid input data","content":{"application/json":{"schema":{"description":"Bad request - Invalid input data","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Cannot update another company","content":{"application/json":{"schema":{"description":"Forbidden - Cannot update another company","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/vendors/stats":{"get":{"summary":"Get vendor dashboard statistics","tags":["vendors"],"description":"Retrieves dashboard statistics for the vendor including product counts, order stats, and revenue metrics","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Statistics retrieved successfully","content":{"application/json":{"schema":{"description":"Statistics retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"stats":{"type":"object","properties":{"totalProducts":{"type":"integer"},"activeProducts":{"type":"integer"},"totalOrders":{"type":"integer"},"pendingOrders":{"type":"integer"},"processingOrders":{"type":"integer"},"completedOrders":{"type":"integer"},"totalRevenue":{"type":"number"},"todayOrders":{"type":"integer"},"todayRevenue":{"type":"number"},"lowStockProducts":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"integer"}}},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}}}}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/vendors/products":{"get":{"summary":"Get vendor products","tags":["vendors"],"description":"Retrieves a paginated list of products belonging to the vendor's company with optional filters","parameters":[{"schema":{"type":"string"},"in":"query","name":"categoryId","required":false,"description":"Filter by category ID"},{"schema":{"type":"boolean"},"in":"query","name":"isActive","required":false,"description":"Filter by active status"},{"schema":{"type":"string"},"in":"query","name":"search","required":false,"description":"Search by product name or SKU"},{"schema":{"type":"integer","minimum":0},"in":"query","name":"minStock","required":false,"description":"Filter by minimum stock level"},{"schema":{"type":"integer","minimum":0},"in":"query","name":"maxStock","required":false,"description":"Filter by maximum stock level"},{"schema":{"type":"integer","minimum":1,"default":1},"in":"query","name":"page","required":false,"description":"Page number for pagination"},{"schema":{"type":"integer","minimum":1,"maximum":100,"default":20},"in":"query","name":"limit","required":false,"description":"Number of items per page"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Products retrieved successfully","content":{"application/json":{"schema":{"description":"Products retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"products":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"integer"}}},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}},"total":{"type":"integer","description":"Total number of products matching the filter"}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}},"post":{"summary":"Create a new product","tags":["vendors"],"description":"Creates a new product for the vendor's company","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["sku","nameAr","nameEn","price","categoryId"],"properties":{"sku":{"type":"string","description":"Unique product SKU"},"nameAr":{"type":"string","description":"Product name in Arabic"},"nameEn":{"type":"string","description":"Product name in English"},"descriptionAr":{"type":"string","description":"Product description in Arabic"},"descriptionEn":{"type":"string","description":"Product description in English"},"price":{"type":"number","minimum":0,"description":"Product price"},"compareAtPrice":{"type":"number","minimum":0,"description":"Original price before discount"},"cost":{"type":"number","minimum":0,"description":"Cost price for profit calculation"},"stock":{"type":"integer","minimum":0,"default":0,"description":"Current stock quantity"},"minOrderQty":{"type":"integer","minimum":1,"default":1,"description":"Minimum order quantity"},"unit":{"type":"string","default":"piece","description":"Unit of measurement (piece, box, carton, etc.)"},"images":{"type":"array","items":{"type":"string"},"description":"Array of image URLs"},"categoryId":{"type":"string","description":"Category ID for the product"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"description":"Available zones for this product"},"isActive":{"type":"boolean","default":true,"description":"Whether the product is active"},"isFeatured":{"type":"boolean","default":false,"description":"Whether the product is featured"},"sortOrder":{"type":"integer","default":0,"description":"Display order for sorting"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"201":{"description":"Product created successfully","content":{"application/json":{"schema":{"description":"Product created successfully","type":"object","properties":{"success":{"type":"boolean"},"product":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"integer"}}},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - Invalid input data or duplicate SKU","content":{"application/json":{"schema":{"description":"Bad request - Invalid input data or duplicate SKU","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"409":{"description":"Conflict - SKU already exists","content":{"application/json":{"schema":{"description":"Conflict - SKU already exists","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/vendors/products/{id}":{"put":{"summary":"Update a product","tags":["vendors"],"description":"Updates an existing product belonging to the vendor's company","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"sku":{"type":"string","description":"Unique product SKU"},"nameAr":{"type":"string","description":"Product name in Arabic"},"nameEn":{"type":"string","description":"Product name in English"},"descriptionAr":{"type":"string","description":"Product description in Arabic"},"descriptionEn":{"type":"string","description":"Product description in English"},"price":{"type":"number","minimum":0,"description":"Product price"},"compareAtPrice":{"type":"number","minimum":0,"description":"Original price before discount"},"cost":{"type":"number","minimum":0,"description":"Cost price for profit calculation"},"stock":{"type":"integer","minimum":0,"description":"Current stock quantity"},"minOrderQty":{"type":"integer","minimum":1,"description":"Minimum order quantity"},"unit":{"type":"string","description":"Unit of measurement (piece, box, carton, etc.)"},"images":{"type":"array","items":{"type":"string"},"description":"Array of image URLs"},"categoryId":{"type":"string","description":"Category ID for the product"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"description":"Available zones for this product"},"isActive":{"type":"boolean","description":"Whether the product is active"},"isFeatured":{"type":"boolean","description":"Whether the product is featured"},"sortOrder":{"type":"integer","description":"Display order for sorting"}}}}}},"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Product ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Product updated successfully","content":{"application/json":{"schema":{"description":"Product updated successfully","type":"object","properties":{"success":{"type":"boolean"},"product":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"integer"}}},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - Invalid input data or duplicate SKU","content":{"application/json":{"schema":{"description":"Bad request - Invalid input data or duplicate SKU","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Product not found or does not belong to vendor","content":{"application/json":{"schema":{"description":"Product not found or does not belong to vendor","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"409":{"description":"Conflict - SKU already exists","content":{"application/json":{"schema":{"description":"Conflict - SKU already exists","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}},"delete":{"summary":"Delete a product","tags":["vendors"],"description":"Soft deletes a product by setting isActive to false. The product will no longer appear in listings.","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Product ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Product deleted successfully","content":{"application/json":{"schema":{"description":"Product deleted successfully","type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Product not found or does not belong to vendor","content":{"application/json":{"schema":{"description":"Product not found or does not belong to vendor","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}},"get":{"summary":"Get product by ID","tags":["vendors"],"description":"Retrieves a single product by ID. The product must belong to the vendor's company.","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Product ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Product retrieved successfully","content":{"application/json":{"schema":{"description":"Product retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"product":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"integer"}}},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Product not found or does not belong to vendor","content":{"application/json":{"schema":{"description":"Product not found or does not belong to vendor","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/vendors/products/{id}/stock":{"patch":{"summary":"Update product stock","tags":["vendors"],"description":"Updates the stock quantity for a product. Supports add, subtract, and set operations. Creates a stock history record.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["quantity","operation"],"properties":{"quantity":{"type":"integer","minimum":0,"description":"Quantity to add, subtract, or set"},"operation":{"type":"string","enum":["add","subtract","set"],"description":"Operation type: add (increase stock), subtract (decrease stock), set (replace stock value)"}}}}},"required":true},"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Product ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Stock updated successfully","content":{"application/json":{"schema":{"description":"Stock updated successfully","type":"object","properties":{"success":{"type":"boolean"},"product":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"integer"}}},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - Invalid input data","content":{"application/json":{"schema":{"description":"Bad request - Invalid input data","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Product not found or does not belong to vendor","content":{"application/json":{"schema":{"description":"Product not found or does not belong to vendor","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/vendors/orders":{"get":{"summary":"Get vendor orders","tags":["vendors"],"description":"Retrieves a paginated list of orders containing products from the vendor's company","parameters":[{"schema":{"type":"string","enum":["PENDING","ACCEPTED","PROCESSING","READY","OUT_FOR_DELIVERY","DELIVERED","CANCELLED","REJECTED","FAILED"]},"in":"query","name":"status","required":false,"description":"Filter by order status"},{"schema":{"type":"string","format":"date-time"},"in":"query","name":"fromDate","required":false,"description":"Filter orders from this date"},{"schema":{"type":"string","format":"date-time"},"in":"query","name":"toDate","required":false,"description":"Filter orders up to this date"},{"schema":{"type":"string"},"in":"query","name":"search","required":false,"description":"Search by order number, customer name, or email"},{"schema":{"type":"integer","minimum":1,"default":1},"in":"query","name":"page","required":false,"description":"Page number for pagination"},{"schema":{"type":"integer","minimum":1,"maximum":100,"default":20},"in":"query","name":"limit","required":false,"description":"Number of items per page"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Orders retrieved successfully","content":{"application/json":{"schema":{"description":"Orders retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"orders":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"orderNumber":{"type":"string"},"userId":{"type":"string"},"user":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"email":{"type":"string"},"phone":{"type":"string","nullable":true},"businessName":{"type":"string","nullable":true}}},"addressId":{"type":"string"},"address":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"street":{"type":"string"},"area":{"type":"string"},"building":{"type":"string","nullable":true},"floor":{"type":"string","nullable":true},"apartment":{"type":"string","nullable":true},"zone":{"type":"string"},"landmark":{"type":"string","nullable":true},"latitude":{"type":"number","nullable":true},"longitude":{"type":"number","nullable":true},"phone":{"type":"string"},"isDefault":{"type":"boolean"}}},"companyId":{"type":"string"},"status":{"type":"string","enum":["PENDING","ACCEPTED","PROCESSING","READY","OUT_FOR_DELIVERY","DELIVERED","CANCELLED","REJECTED","FAILED"]},"subtotal":{"type":"number"},"discount":{"type":"number"},"deliveryFee":{"type":"number"},"total":{"type":"number"},"notes":{"type":"string","nullable":true},"promotionId":{"type":"string","nullable":true},"zone":{"type":"string"},"paymentMethod":{"type":"string","nullable":true},"paymentStatus":{"type":"string","nullable":true},"deliveryDate":{"type":"string","format":"date-time","nullable":true},"deliveredAt":{"type":"string","format":"date-time","nullable":true},"cancelledAt":{"type":"string","format":"date-time","nullable":true},"cancelReason":{"type":"string","nullable":true},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"items":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"orderId":{"type":"string"},"productId":{"type":"string"},"product":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"integer"}}},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"price":{"type":"number"},"quantity":{"type":"integer"},"discount":{"type":"number"},"total":{"type":"number"}}}},"vendorItems":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"orderId":{"type":"string"},"productId":{"type":"string"},"product":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"integer"}}},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"price":{"type":"number"},"quantity":{"type":"integer"},"discount":{"type":"number"},"total":{"type":"number"}}}},"vendorSubtotal":{"type":"number"},"vendorDiscount":{"type":"number"},"vendorTotal":{"type":"number"},"statusHistory":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"orderId":{"type":"string"},"fromStatus":{"type":"string","nullable":true},"toStatus":{"type":"string"},"comment":{"type":"string","nullable":true},"changedBy":{"type":"string","nullable":true},"createdAt":{"type":"string","format":"date-time"}}}}}}},"total":{"type":"integer","description":"Total number of orders matching the filter"}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/vendors/orders/{id}/status":{"patch":{"summary":"Update order status","tags":["vendors"],"description":"Updates the status of an order containing vendor products. Status transitions must follow valid workflow paths.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["status"],"properties":{"status":{"type":"string","enum":["PENDING","ACCEPTED","PROCESSING","READY","OUT_FOR_DELIVERY","DELIVERED","CANCELLED","REJECTED","FAILED"],"description":"New order status. Valid transitions: PENDING -> ACCEPTED/REJECTED, ACCEPTED -> PROCESSING/CANCELLED, PROCESSING -> READY/CANCELLED, READY -> OUT_FOR_DELIVERY, OUT_FOR_DELIVERY -> DELIVERED/FAILED, FAILED -> PROCESSING"},"comment":{"type":"string","description":"Optional comment for the status change"}}}}},"required":true},"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Order ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Order status updated successfully","content":{"application/json":{"schema":{"description":"Order status updated successfully","type":"object","properties":{"success":{"type":"boolean"},"order":{"type":"object","properties":{"id":{"type":"string"},"orderNumber":{"type":"string"},"userId":{"type":"string"},"user":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"email":{"type":"string"},"phone":{"type":"string","nullable":true},"businessName":{"type":"string","nullable":true}}},"addressId":{"type":"string"},"address":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"street":{"type":"string"},"area":{"type":"string"},"building":{"type":"string","nullable":true},"floor":{"type":"string","nullable":true},"apartment":{"type":"string","nullable":true},"zone":{"type":"string"},"landmark":{"type":"string","nullable":true},"latitude":{"type":"number","nullable":true},"longitude":{"type":"number","nullable":true},"phone":{"type":"string"},"isDefault":{"type":"boolean"}}},"companyId":{"type":"string"},"status":{"type":"string","enum":["PENDING","ACCEPTED","PROCESSING","READY","OUT_FOR_DELIVERY","DELIVERED","CANCELLED","REJECTED","FAILED"]},"subtotal":{"type":"number"},"discount":{"type":"number"},"deliveryFee":{"type":"number"},"total":{"type":"number"},"notes":{"type":"string","nullable":true},"promotionId":{"type":"string","nullable":true},"zone":{"type":"string"},"paymentMethod":{"type":"string","nullable":true},"paymentStatus":{"type":"string","nullable":true},"deliveryDate":{"type":"string","format":"date-time","nullable":true},"deliveredAt":{"type":"string","format":"date-time","nullable":true},"cancelledAt":{"type":"string","format":"date-time","nullable":true},"cancelReason":{"type":"string","nullable":true},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"items":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"orderId":{"type":"string"},"productId":{"type":"string"},"product":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"integer"}}},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"price":{"type":"number"},"quantity":{"type":"integer"},"discount":{"type":"number"},"total":{"type":"number"}}}},"vendorItems":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"orderId":{"type":"string"},"productId":{"type":"string"},"product":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"integer"}}},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"price":{"type":"number"},"quantity":{"type":"integer"},"discount":{"type":"number"},"total":{"type":"number"}}}},"vendorSubtotal":{"type":"number"},"vendorDiscount":{"type":"number"},"vendorTotal":{"type":"number"},"statusHistory":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"orderId":{"type":"string"},"fromStatus":{"type":"string","nullable":true},"toStatus":{"type":"string"},"comment":{"type":"string","nullable":true},"changedBy":{"type":"string","nullable":true},"createdAt":{"type":"string","format":"date-time"}}}}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - Invalid status transition","content":{"application/json":{"schema":{"description":"Bad request - Invalid status transition","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Order not found or does not contain vendor products","content":{"application/json":{"schema":{"description":"Order not found or does not contain vendor products","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/vendors/customers":{"get":{"summary":"Get vendor customers","tags":["vendors"],"description":"Retrieves a paginated list of customers who have ordered products from the vendor's company, including order statistics","parameters":[{"schema":{"type":"integer","minimum":1,"default":1},"in":"query","name":"page","required":false,"description":"Page number for pagination"},{"schema":{"type":"integer","minimum":1,"maximum":100,"default":20},"in":"query","name":"limit","required":false,"description":"Number of items per page"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Customers retrieved successfully","content":{"application/json":{"schema":{"description":"Customers retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"customers":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"email":{"type":"string"},"phone":{"type":"string","nullable":true},"businessName":{"type":"string","nullable":true},"createdAt":{"type":"string","format":"date-time"},"totalOrders":{"type":"integer"},"totalSpent":{"type":"number"},"lastOrderDate":{"type":"string","format":"date-time","nullable":true}}}},"total":{"type":"integer","description":"Total number of customers"}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/vendors/export/{type}":{"get":{"summary":"Export vendor data","tags":["vendors"],"description":"Exports vendor data (products, orders, or customers) in JSON or CSV format for download","parameters":[{"schema":{"type":"string","enum":["json","csv"],"default":"json"},"in":"query","name":"format","required":false,"description":"Export format"},{"schema":{"type":"string","enum":["products","orders","customers"]},"in":"path","name":"type","required":true,"description":"Type of data to export"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Data exported successfully. Content-Type header will indicate format (application/json or text/csv)","content":{"application/json":{"schema":{"description":"Data exported successfully. Content-Type header will indicate format (application/json or text/csv)","type":"string"}}}},"400":{"description":"Bad request - Invalid data type","content":{"application/json":{"schema":{"description":"Bad request - Invalid data type","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/vendors/orders/{id}":{"get":{"summary":"Get order by ID","tags":["vendors"],"description":"Retrieves a single order by ID. The order must contain at least one product from the vendor's company. Returns vendor-specific totals.","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Order ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Order retrieved successfully","content":{"application/json":{"schema":{"description":"Order retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"order":{"type":"object","properties":{"id":{"type":"string"},"orderNumber":{"type":"string"},"userId":{"type":"string"},"user":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"email":{"type":"string"},"phone":{"type":"string","nullable":true},"businessName":{"type":"string","nullable":true}}},"addressId":{"type":"string"},"address":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"street":{"type":"string"},"area":{"type":"string"},"building":{"type":"string","nullable":true},"floor":{"type":"string","nullable":true},"apartment":{"type":"string","nullable":true},"zone":{"type":"string"},"landmark":{"type":"string","nullable":true},"latitude":{"type":"number","nullable":true},"longitude":{"type":"number","nullable":true},"phone":{"type":"string"},"isDefault":{"type":"boolean"}}},"companyId":{"type":"string"},"status":{"type":"string","enum":["PENDING","ACCEPTED","PROCESSING","READY","OUT_FOR_DELIVERY","DELIVERED","CANCELLED","REJECTED","FAILED"]},"subtotal":{"type":"number"},"discount":{"type":"number"},"deliveryFee":{"type":"number"},"total":{"type":"number"},"notes":{"type":"string","nullable":true},"promotionId":{"type":"string","nullable":true},"zone":{"type":"string"},"paymentMethod":{"type":"string","nullable":true},"paymentStatus":{"type":"string","nullable":true},"deliveryDate":{"type":"string","format":"date-time","nullable":true},"deliveredAt":{"type":"string","format":"date-time","nullable":true},"cancelledAt":{"type":"string","format":"date-time","nullable":true},"cancelReason":{"type":"string","nullable":true},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"items":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"orderId":{"type":"string"},"productId":{"type":"string"},"product":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"integer"}}},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"price":{"type":"number"},"quantity":{"type":"integer"},"discount":{"type":"number"},"total":{"type":"number"}}}},"vendorItems":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"orderId":{"type":"string"},"productId":{"type":"string"},"product":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"category":{"type":"object","properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"slug":{"type":"string"},"description":{"type":"string","nullable":true},"image":{"type":"string","nullable":true},"parentId":{"type":"string","nullable":true},"isActive":{"type":"boolean"},"displayOrder":{"type":"integer"}}},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"integer"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"price":{"type":"number"},"quantity":{"type":"integer"},"discount":{"type":"number"},"total":{"type":"number"}}}},"vendorSubtotal":{"type":"number","description":"Subtotal for vendor items only"},"vendorDiscount":{"type":"number","description":"Total discount for vendor items"},"vendorTotal":{"type":"number","description":"Total for vendor items after discount"},"statusHistory":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"orderId":{"type":"string"},"fromStatus":{"type":"string","nullable":true},"toStatus":{"type":"string"},"comment":{"type":"string","nullable":true},"changedBy":{"type":"string","nullable":true},"createdAt":{"type":"string","format":"date-time"}}}}}}}}}}},"401":{"description":"Unauthorized - Invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - Invalid or missing token","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - Insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - Insufficient permissions","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"404":{"description":"Order not found or does not contain vendor products","content":{"application/json":{"schema":{"description":"Order not found or does not contain vendor products","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/cart/validate":{"post":{"summary":"Validate cart items","tags":["cart"],"description":"Validates cart items by checking product availability, stock levels, and minimum order quantities. Returns a cart summary with vendor grouping. This endpoint does not require authentication and can be used by guests.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["items"],"properties":{"items":{"type":"array","items":{"type":"object","required":["productId","quantity"],"properties":{"productId":{"type":"string","format":"uuid","description":"Unique identifier of the product"},"quantity":{"type":"integer","minimum":1,"description":"Quantity of the product"},"price":{"type":"number","minimum":0,"nullable":true,"description":"Custom price (optional, uses product price if not provided)"},"discount":{"type":"number","minimum":0,"nullable":true,"description":"Discount per unit (optional)"}}},"minItems":1,"description":"Array of cart items"},"userId":{"type":"string","format":"uuid","nullable":true,"description":"Optional user ID for personalized pricing and delivery fees"}}}}},"required":true},"responses":{"200":{"description":"Cart validated successfully","content":{"application/json":{"schema":{"description":"Cart validated successfully","type":"object","properties":{"success":{"type":"boolean","description":"Indicates successful validation"},"summary":{"type":"object","properties":{"vendorGroups":{"type":"array","items":{"type":"object","properties":{"companyId":{"type":"string","description":"Vendor/Company ID"},"companyName":{"type":"string","description":"Vendor/Company name"},"items":{"type":"array","items":{"type":"object","properties":{"productId":{"type":"string"},"quantity":{"type":"integer"},"price":{"type":"number"},"discount":{"type":"number","nullable":true},"product":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"price":{"type":"number"},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string","nullable":true},"companyId":{"type":"string","nullable":true},"isActive":{"type":"boolean"}}},"subtotal":{"type":"number","description":"Item subtotal (price * quantity)"},"discountAmount":{"type":"number","description":"Total discount for this item"},"total":{"type":"number","description":"Final total after discount"}}},"description":"Items from this vendor"},"subtotal":{"type":"number","description":"Subtotal for all items from this vendor"},"discount":{"type":"number","description":"Total discount for this vendor group"},"deliveryFee":{"type":"number","description":"Delivery fee for this vendor"},"total":{"type":"number","description":"Total including delivery fee minus discounts"}}},"description":"Cart items grouped by vendor"},"totalItems":{"type":"integer","description":"Total number of distinct items"},"subtotal":{"type":"number","description":"Subtotal of all items before discounts"},"totalDiscount":{"type":"number","description":"Total discount applied"},"totalDeliveryFee":{"type":"number","description":"Total delivery fees from all vendors"},"grandTotal":{"type":"number","description":"Final total to pay"}}},"message":{"type":"string","description":"Success message"}}}}}},"400":{"description":"Bad Request - Invalid input or validation errors","content":{"application/json":{"schema":{"description":"Bad Request - Invalid input or validation errors","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}}}}},"/api/cart/summary":{"post":{"summary":"Get authenticated cart summary","tags":["cart"],"description":"Generates a detailed cart summary for authenticated users including personalized delivery fees based on user zone, delivery time estimates, and vendor grouping. Requires authentication to access user-specific pricing and delivery options.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["items"],"properties":{"items":{"type":"array","items":{"type":"object","required":["productId","quantity"],"properties":{"productId":{"type":"string","format":"uuid","description":"Unique identifier of the product"},"quantity":{"type":"integer","minimum":1,"description":"Quantity of the product"},"price":{"type":"number","minimum":0,"nullable":true,"description":"Custom price (optional, uses product price if not provided)"},"discount":{"type":"number","minimum":0,"nullable":true,"description":"Discount per unit (optional)"}}},"minItems":1,"description":"Array of cart items"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Cart summary generated successfully","content":{"application/json":{"schema":{"description":"Cart summary generated successfully","type":"object","properties":{"success":{"type":"boolean"},"summary":{"type":"object","properties":{"vendorGroups":{"type":"array","items":{"type":"object","properties":{"companyId":{"type":"string","description":"Vendor/Company ID"},"companyName":{"type":"string","description":"Vendor/Company name"},"items":{"type":"array","items":{"type":"object","properties":{"productId":{"type":"string"},"quantity":{"type":"integer"},"price":{"type":"number"},"discount":{"type":"number","nullable":true},"product":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"price":{"type":"number"},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string","nullable":true},"companyId":{"type":"string","nullable":true},"isActive":{"type":"boolean"}}},"subtotal":{"type":"number","description":"Item subtotal (price * quantity)"},"discountAmount":{"type":"number","description":"Total discount for this item"},"total":{"type":"number","description":"Final total after discount"}}},"description":"Items from this vendor"},"subtotal":{"type":"number","description":"Subtotal for all items from this vendor"},"discount":{"type":"number","description":"Total discount for this vendor group"},"deliveryFee":{"type":"number","description":"Delivery fee for this vendor"},"total":{"type":"number","description":"Total including delivery fee minus discounts"}}},"description":"Cart items grouped by vendor"},"totalItems":{"type":"integer","description":"Total number of distinct items"},"subtotal":{"type":"number","description":"Subtotal of all items before discounts"},"totalDiscount":{"type":"number","description":"Total discount applied"},"totalDeliveryFee":{"type":"number","description":"Total delivery fees from all vendors"},"grandTotal":{"type":"number","description":"Final total to pay"}}},"deliveryEstimate":{"type":"object","properties":{"minDays":{"type":"integer","description":"Minimum delivery days"},"maxDays":{"type":"integer","description":"Maximum delivery days"},"estimatedDate":{"type":"string","format":"date-time","description":"Estimated delivery date"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad Request - Invalid input or validation errors","content":{"application/json":{"schema":{"description":"Bad Request - Invalid input or validation errors","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}},"401":{"description":"Unauthorized - Authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - Authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}}}}},"/api/cart/checkout":{"post":{"summary":"Checkout and create orders","tags":["cart"],"description":"Processes the cart checkout, validates all items, applies promotions, and creates one order per vendor. Stock is decremented atomically, and order history is created. Returns all created orders with their details.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["addressId","items"],"properties":{"addressId":{"type":"string","format":"uuid","description":"ID of the delivery address"},"items":{"type":"array","items":{"type":"object","required":["productId","quantity"],"properties":{"productId":{"type":"string","format":"uuid","description":"Unique identifier of the product"},"quantity":{"type":"integer","minimum":1,"description":"Quantity of the product"},"price":{"type":"number","minimum":0,"nullable":true,"description":"Custom price (optional, uses product price if not provided)"},"discount":{"type":"number","minimum":0,"nullable":true,"description":"Discount per unit (optional)"}}},"minItems":1,"description":"Array of cart items"},"paymentMethod":{"type":"string","enum":["CASH_ON_DELIVERY","CREDIT_CARD","BANK_TRANSFER","WALLET"],"default":"CASH_ON_DELIVERY","description":"Payment method for the order"},"notes":{"type":"string","nullable":true,"description":"Additional notes for the order"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"201":{"description":"Orders created successfully","content":{"application/json":{"schema":{"description":"Orders created successfully","type":"object","properties":{"success":{"type":"boolean"},"orders":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"orderNumber":{"type":"string"},"userId":{"type":"string"},"addressId":{"type":"string"},"status":{"type":"string","enum":["PENDING","CONFIRMED","PROCESSING","SHIPPED","DELIVERED","CANCELLED","REFUNDED"]},"subtotal":{"type":"number"},"discount":{"type":"number"},"deliveryFee":{"type":"number"},"total":{"type":"number"},"paymentMethod":{"type":"string","nullable":true},"paymentStatus":{"type":"string","nullable":true},"notes":{"type":"string","nullable":true},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"items":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"orderId":{"type":"string"},"productId":{"type":"string"},"quantity":{"type":"integer"},"price":{"type":"number"},"discount":{"type":"number","nullable":true},"total":{"type":"number"},"product":{"type":"object","properties":{"id":{"type":"string"},"nameEn":{"type":"string"},"nameAr":{"type":"string"},"sku":{"type":"string"},"images":{"type":"array","items":{"type":"string"}}}}}}},"address":{"type":"object","properties":{"id":{"type":"string"},"label":{"type":"string"},"street":{"type":"string"},"city":{"type":"string"},"zone":{"type":"string"}}},"statusHistory":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"fromStatus":{"type":"string"},"toStatus":{"type":"string"},"comment":{"type":"string","nullable":true},"createdAt":{"type":"string","format":"date-time"}}}}}},"description":"Array of created orders (one per vendor)"},"orderCount":{"type":"integer","description":"Number of orders created"},"message":{"type":"string"}}}}}},"400":{"description":"Bad Request - Invalid input, insufficient stock, or validation errors","content":{"application/json":{"schema":{"description":"Bad Request - Invalid input, insufficient stock, or validation errors","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}},"401":{"description":"Unauthorized - Authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - Authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}},"404":{"description":"Not Found - User or address not found","content":{"application/json":{"schema":{"description":"Not Found - User or address not found","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}}}}},"/api/cart/save":{"post":{"summary":"Save cart for later","tags":["cart"],"description":"Persists the current cart items for the authenticated user. Cart data is saved and can be retrieved later using the GET /saved endpoint. Useful for users who want to continue shopping later.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["items"],"properties":{"items":{"type":"array","items":{"type":"object","required":["productId","quantity"],"properties":{"productId":{"type":"string","format":"uuid","description":"Unique identifier of the product"},"quantity":{"type":"integer","minimum":1,"description":"Quantity of the product"},"price":{"type":"number","minimum":0,"nullable":true,"description":"Custom price (optional, uses product price if not provided)"},"discount":{"type":"number","minimum":0,"nullable":true,"description":"Discount per unit (optional)"}}},"description":"Array of cart items to save (can be empty to clear)"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Cart saved successfully","content":{"application/json":{"schema":{"description":"Cart saved successfully","type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"}}}}}},"400":{"description":"Bad Request - Invalid input","content":{"application/json":{"schema":{"description":"Bad Request - Invalid input","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}},"401":{"description":"Unauthorized - Authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - Authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}}}}},"/api/cart/saved":{"get":{"summary":"Get saved cart","tags":["cart"],"description":"Retrieves the previously saved cart items for the authenticated user. Returns an empty array if no cart has been saved.","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Saved cart retrieved successfully","content":{"application/json":{"schema":{"description":"Saved cart retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"items":{"type":"array","items":{"type":"object","required":["productId","quantity"],"properties":{"productId":{"type":"string","format":"uuid","description":"Unique identifier of the product"},"quantity":{"type":"integer","minimum":1,"description":"Quantity of the product"},"price":{"type":"number","minimum":0,"nullable":true,"description":"Custom price (optional, uses product price if not provided)"},"discount":{"type":"number","minimum":0,"nullable":true,"description":"Discount per unit (optional)"}}},"description":"Array of saved cart items"},"itemCount":{"type":"integer","description":"Number of items in saved cart"}}}}}},"401":{"description":"Unauthorized - Authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - Authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}}}}},"/api/cart/clear":{"delete":{"summary":"Clear saved cart","tags":["cart"],"description":"Removes all items from the authenticated user's saved cart. This action is irreversible.","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Cart cleared successfully","content":{"application/json":{"schema":{"description":"Cart cleared successfully","type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - Authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - Authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}}}}},"/api/cart/merge":{"post":{"summary":"Merge guest cart with user cart","tags":["cart"],"description":"Merges a guest cart (from localStorage or session) with the authenticated user's saved cart. Duplicate products have their quantities combined. Useful when a guest user logs in and wants to preserve their cart.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["guestItems"],"properties":{"guestItems":{"type":"array","items":{"type":"object","required":["productId","quantity"],"properties":{"productId":{"type":"string","format":"uuid","description":"Unique identifier of the product"},"quantity":{"type":"integer","minimum":1,"description":"Quantity of the product"},"price":{"type":"number","minimum":0,"nullable":true,"description":"Custom price (optional, uses product price if not provided)"},"discount":{"type":"number","minimum":0,"nullable":true,"description":"Discount per unit (optional)"}}},"description":"Cart items from guest session to merge"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Cart merged successfully","content":{"application/json":{"schema":{"description":"Cart merged successfully","type":"object","properties":{"success":{"type":"boolean"},"items":{"type":"array","items":{"type":"object","required":["productId","quantity"],"properties":{"productId":{"type":"string","format":"uuid","description":"Unique identifier of the product"},"quantity":{"type":"integer","minimum":1,"description":"Quantity of the product"},"price":{"type":"number","minimum":0,"nullable":true,"description":"Custom price (optional, uses product price if not provided)"},"discount":{"type":"number","minimum":0,"nullable":true,"description":"Discount per unit (optional)"}}},"description":"Merged cart items"},"itemCount":{"type":"integer","description":"Number of items after merge"},"message":{"type":"string"}}}}}},"400":{"description":"Bad Request - Invalid input","content":{"application/json":{"schema":{"description":"Bad Request - Invalid input","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}},"401":{"description":"Unauthorized - Authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - Authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}}}}},"/api/cart/promotions":{"post":{"summary":"Apply promotions to cart","tags":["cart"],"description":"Validates cart items and applies all eligible promotions based on the user's zone, product categories, and current active promotions. Returns items with applied discounts and an updated cart summary.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["items"],"properties":{"items":{"type":"array","items":{"type":"object","required":["productId","quantity"],"properties":{"productId":{"type":"string","format":"uuid","description":"Unique identifier of the product"},"quantity":{"type":"integer","minimum":1,"description":"Quantity of the product"},"price":{"type":"number","minimum":0,"nullable":true,"description":"Custom price (optional, uses product price if not provided)"},"discount":{"type":"number","minimum":0,"nullable":true,"description":"Discount per unit (optional)"}}},"minItems":1,"description":"Array of cart items"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Promotions applied successfully","content":{"application/json":{"schema":{"description":"Promotions applied successfully","type":"object","properties":{"success":{"type":"boolean"},"items":{"type":"array","items":{"type":"object","properties":{"productId":{"type":"string"},"quantity":{"type":"integer"},"price":{"type":"number"},"discount":{"type":"number","description":"Discount per unit after promotion"},"product":{"type":"object","properties":{"id":{"type":"string"},"nameEn":{"type":"string"},"nameAr":{"type":"string"},"price":{"type":"number"}}},"appliedPromotion":{"type":"object","nullable":true,"properties":{"id":{"type":"string"},"code":{"type":"string"},"name":{"type":"string"},"discountType":{"type":"string","enum":["PERCENTAGE","FIXED_AMOUNT"]},"discountValue":{"type":"number"}},"description":"Applied promotion details (null if no promotion applied)"}}},"description":"Cart items with applied promotions"},"summary":{"type":"object","properties":{"vendorGroups":{"type":"array","items":{"type":"object","properties":{"companyId":{"type":"string","description":"Vendor/Company ID"},"companyName":{"type":"string","description":"Vendor/Company name"},"items":{"type":"array","items":{"type":"object","properties":{"productId":{"type":"string"},"quantity":{"type":"integer"},"price":{"type":"number"},"discount":{"type":"number","nullable":true},"product":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"price":{"type":"number"},"stock":{"type":"integer"},"minOrderQty":{"type":"integer"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string","nullable":true},"companyId":{"type":"string","nullable":true},"isActive":{"type":"boolean"}}},"subtotal":{"type":"number","description":"Item subtotal (price * quantity)"},"discountAmount":{"type":"number","description":"Total discount for this item"},"total":{"type":"number","description":"Final total after discount"}}},"description":"Items from this vendor"},"subtotal":{"type":"number","description":"Subtotal for all items from this vendor"},"discount":{"type":"number","description":"Total discount for this vendor group"},"deliveryFee":{"type":"number","description":"Delivery fee for this vendor"},"total":{"type":"number","description":"Total including delivery fee minus discounts"}}},"description":"Cart items grouped by vendor"},"totalItems":{"type":"integer","description":"Total number of distinct items"},"subtotal":{"type":"number","description":"Subtotal of all items before discounts"},"totalDiscount":{"type":"number","description":"Total discount applied"},"totalDeliveryFee":{"type":"number","description":"Total delivery fees from all vendors"},"grandTotal":{"type":"number","description":"Final total to pay"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad Request - Validation errors","content":{"application/json":{"schema":{"description":"Bad Request - Validation errors","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"},"errors":{"type":"array","items":{"type":"string"},"description":"List of validation errors"}}}}}},"401":{"description":"Unauthorized - Authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - Authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}}}}},"/api/cart/check-availability":{"post":{"summary":"Check product availability","tags":["cart"],"description":"Checks the availability of products in the cart including stock levels, minimum order quantities, and product active status. This endpoint does not require authentication and can be used by guests.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["items"],"properties":{"items":{"type":"array","items":{"type":"object","required":["productId","quantity"],"properties":{"productId":{"type":"string","format":"uuid","description":"Unique identifier of the product"},"quantity":{"type":"integer","minimum":1,"description":"Quantity of the product"},"price":{"type":"number","minimum":0,"nullable":true,"description":"Custom price (optional, uses product price if not provided)"},"discount":{"type":"number","minimum":0,"nullable":true,"description":"Discount per unit (optional)"}}},"minItems":1,"description":"Array of cart items"}}}}},"required":true},"responses":{"200":{"description":"Availability check completed","content":{"application/json":{"schema":{"description":"Availability check completed","type":"object","properties":{"success":{"type":"boolean"},"valid":{"type":"boolean","description":"Whether all items are available"},"errors":{"type":"array","items":{"type":"string"},"description":"List of availability issues"},"availability":{"type":"array","items":{"type":"object","properties":{"productId":{"type":"string","description":"Product ID"},"productName":{"type":"string","description":"Product name (English)"},"requestedQuantity":{"type":"integer","description":"Quantity requested in cart"},"availableStock":{"type":"integer","description":"Current stock available"},"isAvailable":{"type":"boolean","description":"Whether requested quantity is available"},"minOrderQty":{"type":"integer","description":"Minimum order quantity for this product"},"isActive":{"type":"boolean","description":"Whether product is active and available for purchase"}}},"description":"Detailed availability status for each item"}}}}}},"400":{"description":"Bad Request - Invalid input","content":{"application/json":{"schema":{"description":"Bad Request - Invalid input","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}}}}},"/api/cart/delivery-fee":{"post":{"summary":"Calculate delivery fees","tags":["cart"],"description":"Calculates delivery fees for the cart based on the user's selected delivery address zone and vendor locations. Fees vary based on whether vendors deliver to the same zone or different zones.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["items"],"properties":{"items":{"type":"array","items":{"type":"object","required":["productId","quantity"],"properties":{"productId":{"type":"string","format":"uuid","description":"Unique identifier of the product"},"quantity":{"type":"integer","minimum":1,"description":"Quantity of the product"},"price":{"type":"number","minimum":0,"nullable":true,"description":"Custom price (optional, uses product price if not provided)"},"discount":{"type":"number","minimum":0,"nullable":true,"description":"Discount per unit (optional)"}}},"minItems":1,"description":"Array of cart items"},"addressId":{"type":"string","format":"uuid","nullable":true,"description":"Optional delivery address ID. If not provided, uses user's default zone."}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Delivery fees calculated successfully","content":{"application/json":{"schema":{"description":"Delivery fees calculated successfully","type":"object","properties":{"success":{"type":"boolean"},"userZone":{"type":"string","enum":["KARKH","RUSAFA"],"nullable":true,"description":"User's delivery zone"},"deliveryDetails":{"type":"array","items":{"type":"object","properties":{"companyId":{"type":"string","description":"Vendor/Company ID"},"companyName":{"type":"string","description":"Vendor/Company name"},"deliveryFee":{"type":"number","description":"Delivery fee for this vendor (in IQD)"},"itemCount":{"type":"integer","description":"Number of items from this vendor"}}},"description":"Delivery fee breakdown by vendor"},"totalDeliveryFee":{"type":"number","description":"Total delivery fee for all vendors (in IQD)"},"message":{"type":"string"}}}}}},"400":{"description":"Bad Request - Invalid input","content":{"application/json":{"schema":{"description":"Bad Request - Invalid input","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}},"401":{"description":"Unauthorized - Authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - Authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Human-readable error message"}}}}}}}}},"/api/companies/":{"post":{"summary":"Create a new company","tags":["companies"],"description":"Create a new company/vendor in the system. Only administrators can create companies. Default delivery fees and commission rates are applied if not specified.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["name","nameAr","email","phone","zones"],"properties":{"name":{"type":"string","minLength":1,"description":"Company name in English"},"nameAr":{"type":"string","minLength":1,"description":"Company name in Arabic"},"description":{"type":"string","description":"Company description in English"},"descriptionAr":{"type":"string","description":"Company description in Arabic"},"logo":{"type":"string","format":"uri","description":"URL to company logo image"},"email":{"type":"string","format":"email","description":"Company contact email address"},"phone":{"type":"string","description":"Company contact phone number"},"address":{"type":"string","description":"Company physical address"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"minItems":1,"description":"Zones where company will operate"},"deliveryFees":{"type":"object","description":"Zone-based delivery fees (default fees applied if not provided), e.g. {\"KARKH\": 2500, \"RUSAFA\": 2500}","additionalProperties":{"type":"number"}},"commissionRate":{"type":"number","minimum":0,"maximum":100,"default":10,"description":"Platform commission percentage (default: 10%)"},"minOrderAmount":{"type":"number","minimum":0,"default":10000,"description":"Minimum order amount in IQD (default: 10,000)"},"maxDeliveryTime":{"type":"number","minimum":0,"default":120,"description":"Maximum delivery time in minutes (default: 120)"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"201":{"description":"Company created successfully","content":{"application/json":{"schema":{"description":"Company created successfully","type":"object","properties":{"success":{"type":"boolean"},"company":{"type":"object","properties":{"id":{"type":"string","description":"Unique company identifier"},"nameAr":{"type":"string","description":"Company name in Arabic"},"nameEn":{"type":"string","description":"Company name in English"},"description":{"type":"string","nullable":true,"description":"Company description"},"logo":{"type":"string","nullable":true,"description":"URL to company logo"},"email":{"type":"string","format":"email","nullable":true,"description":"Company contact email"},"phone":{"type":"string","nullable":true,"description":"Company contact phone number"},"address":{"type":"string","nullable":true,"description":"Company physical address"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"description":"Zones where company operates"},"isActive":{"type":"boolean","description":"Whether the company is active"},"commission":{"type":"number","description":"Platform commission percentage"},"deliveryFees":{"type":"object","description":"Zone-based delivery fees","additionalProperties":{"type":"number"}},"createdAt":{"type":"string","format":"date-time","description":"Company creation timestamp"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - validation error or duplicate entry","content":{"application/json":{"schema":{"description":"Bad request - validation error or duplicate entry","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}},"get":{"summary":"List companies","tags":["companies"],"description":"Retrieve a paginated list of companies with optional filters for zone, active status, and search term.","parameters":[{"schema":{"type":"string","enum":["KARKH","RUSAFA"]},"in":"query","name":"zone","required":false,"description":"Filter by zone"},{"schema":{"type":"string","enum":["true","false"]},"in":"query","name":"isActive","required":false,"description":"Filter by active status"},{"schema":{"type":"string"},"in":"query","name":"search","required":false,"description":"Search by company name or email"},{"schema":{"type":"number","minimum":1,"default":1},"in":"query","name":"page","required":false,"description":"Page number for pagination"},{"schema":{"type":"number","minimum":1,"maximum":100,"default":20},"in":"query","name":"limit","required":false,"description":"Number of items per page"}],"responses":{"200":{"description":"Paginated list of companies","content":{"application/json":{"schema":{"description":"Paginated list of companies","type":"object","properties":{"success":{"type":"boolean"},"companies":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","description":"Unique company identifier"},"nameAr":{"type":"string","description":"Company name in Arabic"},"nameEn":{"type":"string","description":"Company name in English"},"description":{"type":"string","nullable":true,"description":"Company description"},"logo":{"type":"string","nullable":true,"description":"URL to company logo"},"email":{"type":"string","format":"email","nullable":true,"description":"Company contact email"},"phone":{"type":"string","nullable":true,"description":"Company contact phone number"},"address":{"type":"string","nullable":true,"description":"Company physical address"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"description":"Zones where company operates"},"isActive":{"type":"boolean","description":"Whether the company is active"},"commission":{"type":"number","description":"Platform commission percentage"},"deliveryFees":{"type":"object","description":"Zone-based delivery fees","additionalProperties":{"type":"number"}},"createdAt":{"type":"string","format":"date-time","description":"Company creation timestamp"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp"},"_count":{"type":"object","properties":{"products":{"type":"number","description":"Total number of products"},"users":{"type":"number","description":"Total number of users/vendors"}}}}}},"total":{"type":"number","description":"Total number of companies matching filters"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/companies/{id}":{"put":{"summary":"Update company details","tags":["companies"],"description":"Update an existing company's details. Admins can update any company, while Company Managers can only update their own company.","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string","minLength":1,"description":"Company name in English"},"nameAr":{"type":"string","minLength":1,"description":"Company name in Arabic"},"description":{"type":"string","description":"Company description in English"},"descriptionAr":{"type":"string","description":"Company description in Arabic"},"logo":{"type":"string","format":"uri","description":"URL to company logo image"},"email":{"type":"string","format":"email","description":"Company contact email address"},"phone":{"type":"string","description":"Company contact phone number"},"address":{"type":"string","description":"Company physical address"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"description":"Zones where company operates"},"deliveryFees":{"type":"object","description":"Zone-based delivery fees","additionalProperties":{"type":"number"}},"commissionRate":{"type":"number","minimum":0,"maximum":100,"description":"Platform commission percentage"},"minOrderAmount":{"type":"number","minimum":0,"description":"Minimum order amount in IQD"},"maxDeliveryTime":{"type":"number","minimum":0,"description":"Maximum delivery time in minutes"}}}}}},"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Company ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Company updated successfully","content":{"application/json":{"schema":{"description":"Company updated successfully","type":"object","properties":{"success":{"type":"boolean"},"company":{"type":"object","properties":{"id":{"type":"string","description":"Unique company identifier"},"nameAr":{"type":"string","description":"Company name in Arabic"},"nameEn":{"type":"string","description":"Company name in English"},"description":{"type":"string","nullable":true,"description":"Company description"},"logo":{"type":"string","nullable":true,"description":"URL to company logo"},"email":{"type":"string","format":"email","nullable":true,"description":"Company contact email"},"phone":{"type":"string","nullable":true,"description":"Company contact phone number"},"address":{"type":"string","nullable":true,"description":"Company physical address"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"description":"Zones where company operates"},"isActive":{"type":"boolean","description":"Whether the company is active"},"commission":{"type":"number","description":"Platform commission percentage"},"deliveryFees":{"type":"object","description":"Zone-based delivery fees","additionalProperties":{"type":"number"}},"createdAt":{"type":"string","format":"date-time","description":"Company creation timestamp"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - validation error","content":{"application/json":{"schema":{"description":"Bad request - validation error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions or not your company","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions or not your company","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}},"get":{"summary":"Get company by ID","tags":["companies"],"description":"Retrieve company details by ID. Public access returns limited data (commission rate and stats are hidden). Authenticated users with appropriate roles get full data.","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Company ID"}],"responses":{"200":{"description":"Company details retrieved successfully","content":{"application/json":{"schema":{"description":"Company details retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"company":{"type":"object","properties":{"id":{"type":"string","description":"Unique company identifier"},"nameAr":{"type":"string","description":"Company name in Arabic"},"nameEn":{"type":"string","description":"Company name in English"},"description":{"type":"string","nullable":true,"description":"Company description"},"logo":{"type":"string","nullable":true,"description":"URL to company logo"},"email":{"type":"string","format":"email","nullable":true,"description":"Company contact email"},"phone":{"type":"string","nullable":true,"description":"Company contact phone number"},"address":{"type":"string","nullable":true,"description":"Company physical address"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"description":"Zones where company operates"},"isActive":{"type":"boolean","description":"Whether the company is active"},"commission":{"type":"number","description":"Platform commission percentage"},"deliveryFees":{"type":"object","description":"Zone-based delivery fees","additionalProperties":{"type":"number"}},"createdAt":{"type":"string","format":"date-time","description":"Company creation timestamp"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp"},"_count":{"type":"object","properties":{"products":{"type":"number","description":"Total number of products"},"users":{"type":"number","description":"Total number of users/vendors"}}},"stats":{"type":"object","properties":{"totalProducts":{"type":"number","description":"Total number of products"},"activeProducts":{"type":"number","description":"Number of active products"},"totalOrders":{"type":"number","description":"Total number of orders"},"pendingOrders":{"type":"number","description":"Number of pending orders"},"totalRevenue":{"type":"number","description":"Total revenue amount"},"totalCommission":{"type":"number","description":"Total commission earned"},"totalVendors":{"type":"number","description":"Total number of vendors"},"activeVendors":{"type":"number","description":"Number of active vendors"},"averageRating":{"type":"number","description":"Average company rating"},"totalReviews":{"type":"number","description":"Total number of reviews"}}}}}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/companies/{id}/stats":{"get":{"summary":"Get company statistics","tags":["companies"],"description":"Retrieve detailed statistics for a company including product counts, order metrics, revenue, and vendor information. Company Managers can only view stats for their own company.","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Company ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Company statistics retrieved successfully","content":{"application/json":{"schema":{"description":"Company statistics retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"stats":{"type":"object","properties":{"totalProducts":{"type":"number","description":"Total number of products"},"activeProducts":{"type":"number","description":"Number of active products"},"totalOrders":{"type":"number","description":"Total number of orders"},"pendingOrders":{"type":"number","description":"Number of pending orders"},"totalRevenue":{"type":"number","description":"Total revenue amount"},"totalCommission":{"type":"number","description":"Total commission earned"},"totalVendors":{"type":"number","description":"Total number of vendors"},"activeVendors":{"type":"number","description":"Number of active vendors"},"averageRating":{"type":"number","description":"Average company rating"},"totalReviews":{"type":"number","description":"Total number of reviews"}}}}}}}},"401":{"description":"Unauthorized - authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions or not your company","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions or not your company","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/companies/{id}/status":{"patch":{"summary":"Toggle company active status","tags":["companies"],"description":"Activate or deactivate a company. When a company is deactivated, all its products are also deactivated. Only administrators can perform this action.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["isActive"],"properties":{"isActive":{"type":"boolean","description":"New active status for the company"}}}}},"required":true},"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Company ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Company status updated successfully","content":{"application/json":{"schema":{"description":"Company status updated successfully","type":"object","properties":{"success":{"type":"boolean"},"company":{"type":"object","properties":{"id":{"type":"string","description":"Unique company identifier"},"nameAr":{"type":"string","description":"Company name in Arabic"},"nameEn":{"type":"string","description":"Company name in English"},"description":{"type":"string","nullable":true,"description":"Company description"},"logo":{"type":"string","nullable":true,"description":"URL to company logo"},"email":{"type":"string","format":"email","nullable":true,"description":"Company contact email"},"phone":{"type":"string","nullable":true,"description":"Company contact phone number"},"address":{"type":"string","nullable":true,"description":"Company physical address"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"description":"Zones where company operates"},"isActive":{"type":"boolean","description":"Whether the company is active"},"commission":{"type":"number","description":"Platform commission percentage"},"deliveryFees":{"type":"object","description":"Zone-based delivery fees","additionalProperties":{"type":"number"}},"createdAt":{"type":"string","format":"date-time","description":"Company creation timestamp"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - validation error","content":{"application/json":{"schema":{"description":"Bad request - validation error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - admin access required","content":{"application/json":{"schema":{"description":"Forbidden - admin access required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/companies/{id}/delivery-fees":{"patch":{"summary":"Update company delivery fees","tags":["companies"],"description":"Update the zone-based delivery fees for a company. Admins can update any company, while Company Managers can only update their own company.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["deliveryFees"],"properties":{"deliveryFees":{"type":"object","description":"Zone-based delivery fees object where keys are zone names and values are fees in IQD, e.g. {\"KARKH\": 2500, \"RUSAFA\": 2500}","additionalProperties":{"type":"number","minimum":0}}}}}},"required":true},"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Company ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Delivery fees updated successfully","content":{"application/json":{"schema":{"description":"Delivery fees updated successfully","type":"object","properties":{"success":{"type":"boolean"},"company":{"type":"object","properties":{"id":{"type":"string","description":"Unique company identifier"},"nameAr":{"type":"string","description":"Company name in Arabic"},"nameEn":{"type":"string","description":"Company name in English"},"description":{"type":"string","nullable":true,"description":"Company description"},"logo":{"type":"string","nullable":true,"description":"URL to company logo"},"email":{"type":"string","format":"email","nullable":true,"description":"Company contact email"},"phone":{"type":"string","nullable":true,"description":"Company contact phone number"},"address":{"type":"string","nullable":true,"description":"Company physical address"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"description":"Zones where company operates"},"isActive":{"type":"boolean","description":"Whether the company is active"},"commission":{"type":"number","description":"Platform commission percentage"},"deliveryFees":{"type":"object","description":"Zone-based delivery fees","additionalProperties":{"type":"number"}},"createdAt":{"type":"string","format":"date-time","description":"Company creation timestamp"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - validation error","content":{"application/json":{"schema":{"description":"Bad request - validation error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions or not your company","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions or not your company","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/companies/{id}/commission":{"patch":{"summary":"Update company commission rate","tags":["companies"],"description":"Update the platform commission rate for a company. Commission rate must be between 0 and 100 percent. Only administrators can perform this action.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["commissionRate"],"properties":{"commissionRate":{"type":"number","minimum":0,"maximum":100,"description":"New commission rate percentage (0-100)"}}}}},"required":true},"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Company ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Commission rate updated successfully","content":{"application/json":{"schema":{"description":"Commission rate updated successfully","type":"object","properties":{"success":{"type":"boolean"},"company":{"type":"object","properties":{"id":{"type":"string","description":"Unique company identifier"},"nameAr":{"type":"string","description":"Company name in Arabic"},"nameEn":{"type":"string","description":"Company name in English"},"description":{"type":"string","nullable":true,"description":"Company description"},"logo":{"type":"string","nullable":true,"description":"URL to company logo"},"email":{"type":"string","format":"email","nullable":true,"description":"Company contact email"},"phone":{"type":"string","nullable":true,"description":"Company contact phone number"},"address":{"type":"string","nullable":true,"description":"Company physical address"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"description":"Zones where company operates"},"isActive":{"type":"boolean","description":"Whether the company is active"},"commission":{"type":"number","description":"Platform commission percentage"},"deliveryFees":{"type":"object","description":"Zone-based delivery fees","additionalProperties":{"type":"number"}},"createdAt":{"type":"string","format":"date-time","description":"Company creation timestamp"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - invalid commission rate","content":{"application/json":{"schema":{"description":"Bad request - invalid commission rate","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - admin access required","content":{"application/json":{"schema":{"description":"Forbidden - admin access required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/companies/{id}/vendors":{"get":{"summary":"Get company vendors","tags":["companies"],"description":"Retrieve a list of vendors associated with a company. Includes vendor details and product counts. Company Managers and Vendors can only view vendors for their own company.","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Company ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"List of company vendors","content":{"application/json":{"schema":{"description":"List of company vendors","type":"object","properties":{"success":{"type":"boolean"},"vendors":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","description":"Vendor user ID"},"email":{"type":"string","format":"email","description":"Vendor email address"},"name":{"type":"string","description":"Vendor name"},"phone":{"type":"string","nullable":true,"description":"Vendor phone number"},"isActive":{"type":"boolean","description":"Whether the vendor is active"},"createdAt":{"type":"string","format":"date-time","description":"Vendor creation timestamp"},"_count":{"type":"object","properties":{"products":{"type":"number","description":"Number of products created by vendor"}}}}}},"total":{"type":"number","description":"Total number of vendors"}}}}}},"401":{"description":"Unauthorized - authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions or not your company","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions or not your company","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/companies/{id}/products":{"get":{"summary":"Get company products","tags":["companies"],"description":"Retrieve a paginated list of products belonging to a specific company. Includes category and vendor information for each product.","parameters":[{"schema":{"type":"number","minimum":1,"default":1},"in":"query","name":"page","required":false,"description":"Page number for pagination"},{"schema":{"type":"number","minimum":1,"maximum":100,"default":20},"in":"query","name":"limit","required":false,"description":"Number of items per page"},{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Company ID"}],"responses":{"200":{"description":"Paginated list of company products","content":{"application/json":{"schema":{"description":"Paginated list of company products","type":"object","properties":{"success":{"type":"boolean"},"products":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"sku":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"},"descriptionAr":{"type":"string","nullable":true},"descriptionEn":{"type":"string","nullable":true},"price":{"type":"number"},"compareAtPrice":{"type":"number","nullable":true},"cost":{"type":"number","nullable":true},"stock":{"type":"number"},"minOrderQty":{"type":"number"},"unit":{"type":"string"},"images":{"type":"array","items":{"type":"string"}},"categoryId":{"type":"string"},"companyId":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}},"isActive":{"type":"boolean"},"isFeatured":{"type":"boolean"},"sortOrder":{"type":"number"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"category":{"type":"object","nullable":true,"properties":{"id":{"type":"string"},"nameAr":{"type":"string"},"nameEn":{"type":"string"}}},"user":{"type":"object","nullable":true,"properties":{"id":{"type":"string"},"name":{"type":"string"},"email":{"type":"string"}}},"_count":{"type":"object","properties":{"orderItems":{"type":"number"}}}}}},"total":{"type":"number","description":"Total number of products"}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/companies/zone/{zone}":{"get":{"summary":"Get companies by zone","tags":["companies"],"description":"Retrieve a list of active companies operating in a specific zone. Only returns companies that have the specified zone in their zones array and are currently active.","parameters":[{"schema":{"type":"string","enum":["KARKH","RUSAFA"]},"in":"path","name":"zone","required":true,"description":"Zone to filter companies by"}],"responses":{"200":{"description":"List of companies in the specified zone","content":{"application/json":{"schema":{"description":"List of companies in the specified zone","type":"object","properties":{"success":{"type":"boolean"},"companies":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","description":"Unique company identifier"},"nameAr":{"type":"string","description":"Company name in Arabic"},"nameEn":{"type":"string","description":"Company name in English"},"description":{"type":"string","nullable":true,"description":"Company description"},"logo":{"type":"string","nullable":true,"description":"URL to company logo"},"email":{"type":"string","format":"email","nullable":true,"description":"Company contact email"},"phone":{"type":"string","nullable":true,"description":"Company contact phone number"},"address":{"type":"string","nullable":true,"description":"Company physical address"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA"]},"description":"Zones where company operates"},"isActive":{"type":"boolean","description":"Whether the company is active"},"commission":{"type":"number","description":"Platform commission percentage"},"deliveryFees":{"type":"object","description":"Zone-based delivery fees","additionalProperties":{"type":"number"}},"createdAt":{"type":"string","format":"date-time","description":"Company creation timestamp"},"updatedAt":{"type":"string","format":"date-time","description":"Last update timestamp"},"_count":{"type":"object","properties":{"products":{"type":"number","description":"Total number of products"},"users":{"type":"number","description":"Total number of users/vendors"}}}}}},"total":{"type":"number","description":"Total number of companies in zone"}}}}}},"400":{"description":"Bad request - invalid zone","content":{"application/json":{"schema":{"description":"Bad request - invalid zone","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/companies/{id}/payouts":{"get":{"summary":"Calculate company payouts","tags":["companies"],"description":"Calculate total payouts for a company based on completed orders. Optionally filter by date range. Shows total revenue, commission deducted, and net payout amount. Company Managers can only view payouts for their own company.","parameters":[{"schema":{"type":"string","format":"date-time"},"in":"query","name":"startDate","required":false,"description":"Start date for payout calculation (ISO 8601 format)"},{"schema":{"type":"string","format":"date-time"},"in":"query","name":"endDate","required":false,"description":"End date for payout calculation (ISO 8601 format)"},{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Company ID"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Company payout calculation","content":{"application/json":{"schema":{"description":"Company payout calculation","type":"object","properties":{"success":{"type":"boolean"},"payouts":{"type":"object","properties":{"companyId":{"type":"string","description":"Company ID"},"period":{"type":"object","properties":{"start":{"type":"string","format":"date-time","nullable":true,"description":"Period start date"},"end":{"type":"string","format":"date-time","nullable":true,"description":"Period end date"}}},"totalOrders":{"type":"number","description":"Total number of completed orders"},"totalRevenue":{"type":"number","description":"Total revenue amount"},"totalCommission":{"type":"number","description":"Total platform commission"},"totalPayout":{"type":"number","description":"Net payout amount (revenue - commission)"},"commissionRate":{"type":"number","description":"Commission rate percentage"}}}}}}}},"401":{"description":"Unauthorized - authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - authentication required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions or not your company","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions or not your company","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/analytics/dashboard/vendor":{"get":{"summary":"Get vendor dashboard statistics","tags":["analytics"],"description":"Retrieve comprehensive dashboard statistics for vendors including revenue, orders, products, customers, and performance metrics. Accessible by VENDOR, COMPANY_MANAGER, ADMIN, and SUPER_ADMIN roles.","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Vendor dashboard statistics retrieved successfully","content":{"application/json":{"schema":{"description":"Vendor dashboard statistics retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"stats":{"type":"object","properties":{"revenue":{"type":"object","properties":{"total":{"type":"number","description":"Total revenue of all time"},"today":{"type":"number","description":"Revenue generated today"},"thisWeek":{"type":"number","description":"Revenue generated this week"},"thisMonth":{"type":"number","description":"Revenue generated this month"},"growth":{"type":"number","description":"Growth percentage compared to last period"}}},"orders":{"type":"object","properties":{"total":{"type":"number","description":"Total number of orders"},"pending":{"type":"number","description":"Number of pending orders"},"processing":{"type":"number","description":"Number of orders being processed"},"completed":{"type":"number","description":"Number of completed orders"},"cancelled":{"type":"number","description":"Number of cancelled orders"},"today":{"type":"number","description":"Orders placed today"},"thisWeek":{"type":"number","description":"Orders placed this week"},"thisMonth":{"type":"number","description":"Orders placed this month"}}},"products":{"type":"object","properties":{"total":{"type":"number","description":"Total number of products"},"active":{"type":"number","description":"Number of active products"},"inactive":{"type":"number","description":"Number of inactive products"},"lowStock":{"type":"number","description":"Products with stock less than 10"},"outOfStock":{"type":"number","description":"Products with zero stock"},"bestSelling":{"type":"array","items":{"type":"object","properties":{"productId":{"type":"string","format":"uuid","description":"Product unique identifier"},"name":{"type":"string","description":"Product name"},"sales":{"type":"number","description":"Total units sold"},"revenue":{"type":"number","description":"Total revenue generated"}}},"description":"Top 5 best selling products"}}},"customers":{"type":"object","properties":{"total":{"type":"number","description":"Total unique customers"},"new":{"type":"number","description":"New customers in last 30 days"},"returning":{"type":"number","description":"Returning customers"},"topCustomers":{"type":"array","items":{"type":"object","properties":{"userId":{"type":"string","format":"uuid","description":"Customer user ID"},"name":{"type":"string","description":"Customer name"},"orderCount":{"type":"number","description":"Total number of orders"},"totalSpent":{"type":"number","description":"Total amount spent"}}},"description":"Top 5 customers by spending"}}},"performance":{"type":"object","properties":{"averageOrderValue":{"type":"number","description":"Average value per order"},"conversionRate":{"type":"number","description":"Conversion rate percentage"},"fulfillmentRate":{"type":"number","description":"Order fulfillment rate percentage"},"averageDeliveryTime":{"type":"number","description":"Average delivery time in hours"}}}}}}}}}},"403":{"description":"Access denied - user does not have vendor permissions","content":{"application/json":{"schema":{"description":"Access denied - user does not have vendor permissions","type":"object","properties":{"error":{"type":"string","description":"Error type, e.g. Forbidden"},"message":{"type":"string","description":"Access denied reason"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/analytics/dashboard/admin":{"get":{"summary":"Get admin dashboard overview","tags":["analytics"],"description":"Retrieve platform-wide statistics and overview for administrators. Includes total users, vendors, companies, products, orders, and revenue metrics. Only accessible by ADMIN and SUPER_ADMIN roles.","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Admin dashboard data retrieved successfully","content":{"application/json":{"schema":{"description":"Admin dashboard data retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"dashboard":{"type":"object","properties":{"overview":{"type":"object","properties":{"totalUsers":{"type":"number","description":"Total registered users"},"totalVendors":{"type":"number","description":"Total vendor accounts"},"totalShopOwners":{"type":"number","description":"Total shop owner accounts"},"totalCompanies":{"type":"number","description":"Total registered companies"},"activeCompanies":{"type":"number","description":"Number of active companies"},"totalProducts":{"type":"number","description":"Total products in platform"},"totalOrders":{"type":"number","description":"Total orders placed"},"todayOrders":{"type":"number","description":"Orders placed today"},"monthOrders":{"type":"number","description":"Orders placed this month"},"totalRevenue":{"type":"number","description":"Total platform revenue"}}},"topCompanies":{"type":"array","items":{"type":"object","properties":{"_sum":{"type":"object","properties":{"totalAmount":{"type":"number","nullable":true,"description":"Total revenue amount"}}},"_count":{"type":"number","description":"Number of orders"}}},"description":"Top 5 performing companies by revenue"}}}}}}}},"401":{"description":"Unauthorized - authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - authentication required","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - admin role required","content":{"application/json":{"schema":{"description":"Forbidden - admin role required","type":"object","properties":{"error":{"type":"string","description":"Error type, e.g. Forbidden"},"message":{"type":"string","description":"Access denied reason"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/analytics/reports/sales":{"post":{"summary":"Generate sales report","tags":["analytics"],"description":"Generate a detailed sales report for a specified date range. Vendors and company managers can only view their own company data. Admins can specify a company ID to view any company data.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["startDate","endDate"],"properties":{"startDate":{"type":"string","format":"date-time","description":"ISO 8601 format, e.g. 2024-01-01T00:00:00.000Z"},"endDate":{"type":"string","format":"date-time","description":"ISO 8601 format, e.g. 2024-12-31T23:59:59.999Z"},"companyId":{"type":"string","format":"uuid","description":"Company ID (optional for admins, ignored for vendors/company managers)"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Sales report generated successfully","content":{"application/json":{"schema":{"description":"Sales report generated successfully","type":"object","properties":{"success":{"type":"boolean"},"report":{"type":"object","properties":{"period":{"type":"object","properties":{"startDate":{"type":"string","format":"date-time","description":"Start date of the period"},"endDate":{"type":"string","format":"date-time","description":"End date of the period"}}},"totalSales":{"type":"number","description":"Total sales amount in period"},"totalOrders":{"type":"number","description":"Total number of orders"},"totalCustomers":{"type":"number","description":"Unique customers count"},"averageOrderValue":{"type":"number","description":"Average value per order"},"topProducts":{"type":"array","items":{"type":"object","properties":{"productId":{"type":"string","format":"uuid","description":"Product ID"},"name":{"type":"string","description":"Product name"},"sales":{"type":"number","description":"Total sales amount"},"quantity":{"type":"number","description":"Total quantity sold"}}},"description":"Top 10 selling products"},"topCategories":{"type":"array","items":{"type":"object","properties":{"categoryId":{"type":"string","format":"uuid","description":"Category ID"},"name":{"type":"string","description":"Category name"},"sales":{"type":"number","description":"Total sales amount"}}},"description":"Top selling categories"},"salesByDate":{"type":"array","items":{"type":"object","properties":{"date":{"type":"string","format":"date","description":"Date of sales"},"sales":{"type":"number","description":"Total sales amount"},"orders":{"type":"number","description":"Number of orders"}}},"description":"Daily sales breakdown"},"salesByZone":{"type":"array","items":{"type":"object","properties":{"zone":{"type":"string","description":"Zone name"},"sales":{"type":"number","description":"Total sales in zone"},"orders":{"type":"number","description":"Number of orders in zone"}}},"description":"Sales breakdown by delivery zone"}}}}}}}},"400":{"description":"Bad request - missing required fields","content":{"application/json":{"schema":{"description":"Bad request - missing required fields","type":"object","properties":{"error":{"type":"string","description":"Error type, e.g. Bad Request"},"message":{"type":"string","description":"Validation error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string","description":"Error type, e.g. Forbidden"},"message":{"type":"string","description":"Access denied reason"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/analytics/reports/commission":{"post":{"summary":"Generate commission report","tags":["analytics"],"description":"Generate a detailed commission report showing revenue, commission deductions, and net payouts for a specified date range. Vendors and company managers can only view their own company data. Admins can specify a company ID.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["startDate","endDate"],"properties":{"startDate":{"type":"string","format":"date-time","description":"ISO 8601 format, e.g. 2024-01-01T00:00:00.000Z"},"endDate":{"type":"string","format":"date-time","description":"ISO 8601 format, e.g. 2024-12-31T23:59:59.999Z"},"companyId":{"type":"string","format":"uuid","description":"Company ID (optional for admins, ignored for vendors/company managers)"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Commission report generated successfully","content":{"application/json":{"schema":{"description":"Commission report generated successfully","type":"object","properties":{"success":{"type":"boolean"},"report":{"type":"object","properties":{"period":{"type":"object","properties":{"startDate":{"type":"string","format":"date-time","description":"Start date of the period"},"endDate":{"type":"string","format":"date-time","description":"End date of the period"}}},"totalRevenue":{"type":"number","description":"Total revenue in period"},"totalCommission":{"type":"number","description":"Total commission deducted"},"totalPayout":{"type":"number","description":"Total net payout"},"commissionRate":{"type":"number","description":"Commission rate percentage"},"transactions":{"type":"array","items":{"type":"object","properties":{"orderId":{"type":"string","format":"uuid","description":"Order ID"},"date":{"type":"string","format":"date-time","description":"Transaction date"},"amount":{"type":"number","description":"Order amount"},"commission":{"type":"number","description":"Commission deducted"},"payout":{"type":"number","description":"Net payout amount"},"status":{"type":"string","description":"Transaction status"}}},"description":"List of commission transactions"}}}}}}}},"400":{"description":"Bad request - missing required fields","content":{"application/json":{"schema":{"description":"Bad request - missing required fields","type":"object","properties":{"error":{"type":"string","description":"Error type, e.g. Bad Request"},"message":{"type":"string","description":"Validation error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string","description":"Error type, e.g. Forbidden"},"message":{"type":"string","description":"Access denied reason"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/analytics/realtime":{"get":{"summary":"Get real-time statistics snapshot","tags":["analytics"],"description":"Retrieve a current snapshot of real-time statistics. Admins receive platform-wide stats, vendors receive their company-specific stats. This endpoint serves as a REST fallback for WebSocket-based real-time updates.","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Real-time stats retrieved successfully","content":{"application/json":{"schema":{"description":"Real-time stats retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"stats":{"oneOf":[{"type":"object","description":"Admin dashboard stats (for ADMIN/SUPER_ADMIN users)","properties":{"overview":{"type":"object","properties":{"totalUsers":{"type":"number","description":"Total registered users"},"totalVendors":{"type":"number","description":"Total vendor accounts"},"totalShopOwners":{"type":"number","description":"Total shop owner accounts"},"totalCompanies":{"type":"number","description":"Total registered companies"},"activeCompanies":{"type":"number","description":"Number of active companies"},"totalProducts":{"type":"number","description":"Total products in platform"},"totalOrders":{"type":"number","description":"Total orders placed"},"todayOrders":{"type":"number","description":"Orders placed today"},"monthOrders":{"type":"number","description":"Orders placed this month"},"totalRevenue":{"type":"number","description":"Total platform revenue"}}},"topCompanies":{"type":"array","items":{"type":"object"}}}},{"type":"object","description":"Vendor dashboard stats (for VENDOR/COMPANY_MANAGER users)","properties":{"revenue":{"type":"object","properties":{"total":{"type":"number","description":"Total revenue of all time"},"today":{"type":"number","description":"Revenue generated today"},"thisWeek":{"type":"number","description":"Revenue generated this week"},"thisMonth":{"type":"number","description":"Revenue generated this month"},"growth":{"type":"number","description":"Growth percentage compared to last period"}}},"orders":{"type":"object","properties":{"total":{"type":"number","description":"Total number of orders"},"pending":{"type":"number","description":"Number of pending orders"},"processing":{"type":"number","description":"Number of orders being processed"},"completed":{"type":"number","description":"Number of completed orders"},"cancelled":{"type":"number","description":"Number of cancelled orders"},"today":{"type":"number","description":"Orders placed today"},"thisWeek":{"type":"number","description":"Orders placed this week"},"thisMonth":{"type":"number","description":"Orders placed this month"}}},"products":{"type":"object","properties":{"total":{"type":"number","description":"Total number of products"},"active":{"type":"number","description":"Number of active products"},"inactive":{"type":"number","description":"Number of inactive products"},"lowStock":{"type":"number","description":"Products with stock less than 10"},"outOfStock":{"type":"number","description":"Products with zero stock"},"bestSelling":{"type":"array","items":{"type":"object","properties":{"productId":{"type":"string","format":"uuid","description":"Product unique identifier"},"name":{"type":"string","description":"Product name"},"sales":{"type":"number","description":"Total units sold"},"revenue":{"type":"number","description":"Total revenue generated"}}},"description":"Top 5 best selling products"}}},"customers":{"type":"object","properties":{"total":{"type":"number","description":"Total unique customers"},"new":{"type":"number","description":"New customers in last 30 days"},"returning":{"type":"number","description":"Returning customers"},"topCustomers":{"type":"array","items":{"type":"object","properties":{"userId":{"type":"string","format":"uuid","description":"Customer user ID"},"name":{"type":"string","description":"Customer name"},"orderCount":{"type":"number","description":"Total number of orders"},"totalSpent":{"type":"number","description":"Total amount spent"}}},"description":"Top 5 customers by spending"}}},"performance":{"type":"object","properties":{"averageOrderValue":{"type":"number","description":"Average value per order"},"conversionRate":{"type":"number","description":"Conversion rate percentage"},"fulfillmentRate":{"type":"number","description":"Order fulfillment rate percentage"},"averageDeliveryTime":{"type":"number","description":"Average delivery time in hours"}}}}}]},"message":{"type":"string"}}}}}},"403":{"description":"Forbidden - no access to real-time stats","content":{"application/json":{"schema":{"description":"Forbidden - no access to real-time stats","type":"object","properties":{"error":{"type":"string","description":"Error type, e.g. Forbidden"},"message":{"type":"string","description":"Access denied reason"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/analytics/reports/export":{"post":{"summary":"Export report to file","tags":["analytics"],"description":"Export analytics reports to various file formats (CSV, PDF, Excel). This endpoint is currently a placeholder for future implementation.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["type","format"],"properties":{"type":{"type":"string","enum":["sales","commission","inventory","customers","orders"],"description":"Type of report to export (e.g. sales)"},"format":{"type":"string","enum":["csv","pdf","excel"],"description":"Export file format (e.g. csv)"},"startDate":{"type":"string","format":"date-time","description":"Report start date - ISO 8601 format, e.g. 2024-01-01T00:00:00.000Z"},"endDate":{"type":"string","format":"date-time","description":"Report end date - ISO 8601 format, e.g. 2024-12-31T23:59:59.999Z"},"companyId":{"type":"string","format":"uuid","description":"Company ID for company-specific reports (optional for admins)"},"filters":{"type":"object","description":"Additional filters for the report","additionalProperties":true}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Export request processed successfully","content":{"application/json":{"schema":{"description":"Export request processed successfully","type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"},"requestedFormat":{"type":"string","enum":["csv","pdf","excel"],"description":"Requested export format"},"requestedType":{"type":"string","enum":["sales","commission","inventory","customers","orders"],"description":"Requested report type"},"downloadUrl":{"type":"string","format":"uri","description":"URL to download the exported file (when implemented)","nullable":true},"expiresAt":{"type":"string","format":"date-time","description":"Expiration time for the download URL (when implemented)","nullable":true}}}}}},"400":{"description":"Bad request - invalid parameters","content":{"application/json":{"schema":{"description":"Bad request - invalid parameters","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Unauthorized - authentication required","content":{"application/json":{"schema":{"description":"Unauthorized - authentication required","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/payouts/request":{"post":{"summary":"Create payout request","tags":["payouts"],"description":"Create a new payout request. Only accessible by COMPANY_MANAGER and VENDOR roles. The payout amount must not exceed the available balance.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["amount","method"],"properties":{"amount":{"type":"number","minimum":1,"description":"Payout amount in IQD (must not exceed available balance)"},"method":{"type":"string","enum":["BANK_TRANSFER","CASH","WALLET","CHECK"],"description":"Payment method for the payout"},"bankDetails":{"type":"object","properties":{"accountName":{"type":"string","description":"Bank account holder name"},"accountNumber":{"type":"string","description":"Bank account number"},"bankName":{"type":"string","description":"Name of the bank"},"iban":{"type":"string","nullable":true,"description":"International Bank Account Number (optional)"},"swiftCode":{"type":"string","nullable":true,"description":"SWIFT/BIC code (optional)"}},"required":["accountName","accountNumber","bankName"],"description":"Required if method is BANK_TRANSFER"},"notes":{"type":"string","description":"Additional notes for the payout request"},"ordersIncluded":{"type":"array","items":{"type":"string","format":"uuid"},"description":"Array of order IDs to include in this payout"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"201":{"description":"Payout request created successfully","content":{"application/json":{"schema":{"description":"Payout request created successfully","type":"object","properties":{"success":{"type":"boolean"},"payout":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"Unique payout identifier"},"companyId":{"type":"string","format":"uuid","description":"Company ID associated with the payout"},"amount":{"type":"number","description":"Payout amount in IQD"},"method":{"type":"string","enum":["BANK_TRANSFER","CASH","WALLET","CHECK"],"description":"Payment method for the payout"},"status":{"type":"string","enum":["PENDING","PROCESSING","COMPLETED","FAILED","CANCELLED"],"description":"Status of the payout request"},"bankDetails":{"type":"object","properties":{"accountName":{"type":"string","description":"Bank account holder name"},"accountNumber":{"type":"string","description":"Bank account number"},"bankName":{"type":"string","description":"Name of the bank"},"iban":{"type":"string","nullable":true,"description":"International Bank Account Number (optional)"},"swiftCode":{"type":"string","nullable":true,"description":"SWIFT/BIC code (optional)"}},"required":["accountName","accountNumber","bankName"],"nullable":true},"notes":{"type":"string","nullable":true,"description":"Additional notes for the payout"},"ordersIncluded":{"type":"array","items":{"type":"string"},"description":"Array of order IDs included in this payout"},"processedBy":{"type":"string","format":"uuid","nullable":true,"description":"ID of admin who processed the payout"},"processedAt":{"type":"string","format":"date-time","nullable":true,"description":"When the payout was processed"},"requestedAt":{"type":"string","format":"date-time","description":"When the payout was requested"},"createdAt":{"type":"string","format":"date-time","description":"Record creation timestamp"},"updatedAt":{"type":"string","format":"date-time","description":"Record last update timestamp"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - validation error or insufficient balance","content":{"application/json":{"schema":{"description":"Bad request - validation error or insufficient balance","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - only company managers and vendors can request payouts","content":{"application/json":{"schema":{"description":"Forbidden - only company managers and vendors can request payouts","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/payouts/balance":{"get":{"summary":"Get available balance for payout","tags":["payouts"],"description":"Retrieve the available balance that can be requested for payout. Company managers and vendors can only view their own company balance, while admins can view any company balance.","parameters":[{"schema":{"type":"string","format":"uuid"},"in":"query","name":"companyId","required":false,"description":"Company ID to check balance for (optional for admins, ignored for company managers/vendors)"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Available balance retrieved successfully","content":{"application/json":{"schema":{"description":"Available balance retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"balance":{"type":"number","description":"Available balance amount in IQD"},"currency":{"type":"string","description":"Currency code (IQD)"}}}}}},"400":{"description":"Bad request - company ID is required","content":{"application/json":{"schema":{"description":"Bad request - company ID is required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions or trying to access another company balance","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions or trying to access another company balance","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/payouts/history":{"get":{"summary":"Get payout history","tags":["payouts"],"description":"Retrieve paginated payout history with optional filters. Company managers and vendors can only view their own company payouts, while admins can view all payouts.","parameters":[{"schema":{"type":"number","minimum":1,"default":1},"in":"query","name":"page","required":false,"description":"Page number for pagination"},{"schema":{"type":"number","minimum":1,"maximum":100,"default":20},"in":"query","name":"limit","required":false,"description":"Number of items per page"},{"schema":{"type":"string","format":"uuid"},"in":"query","name":"companyId","required":false,"description":"Filter by company ID (admins only)"},{"schema":{"type":"string","enum":["PENDING","PROCESSING","COMPLETED","FAILED","CANCELLED"]},"in":"query","name":"status","required":false,"description":"Filter by payout status"},{"schema":{"type":"string","enum":["BANK_TRANSFER","CASH","WALLET","CHECK"]},"in":"query","name":"method","required":false,"description":"Filter by payment method"},{"schema":{"type":"string","format":"date"},"in":"query","name":"fromDate","required":false,"description":"Filter payouts from this date (YYYY-MM-DD)"},{"schema":{"type":"string","format":"date"},"in":"query","name":"toDate","required":false,"description":"Filter payouts until this date (YYYY-MM-DD)"},{"schema":{"type":"number","minimum":0},"in":"query","name":"minAmount","required":false,"description":"Minimum payout amount filter"},{"schema":{"type":"number","minimum":0},"in":"query","name":"maxAmount","required":false,"description":"Maximum payout amount filter"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Payout history retrieved successfully","content":{"application/json":{"schema":{"description":"Payout history retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"payouts":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"Unique payout identifier"},"companyId":{"type":"string","format":"uuid","description":"Company ID associated with the payout"},"amount":{"type":"number","description":"Payout amount in IQD"},"method":{"type":"string","enum":["BANK_TRANSFER","CASH","WALLET","CHECK"],"description":"Payment method for the payout"},"status":{"type":"string","enum":["PENDING","PROCESSING","COMPLETED","FAILED","CANCELLED"],"description":"Status of the payout request"},"bankDetails":{"type":"object","properties":{"accountName":{"type":"string","description":"Bank account holder name"},"accountNumber":{"type":"string","description":"Bank account number"},"bankName":{"type":"string","description":"Name of the bank"},"iban":{"type":"string","nullable":true,"description":"International Bank Account Number (optional)"},"swiftCode":{"type":"string","nullable":true,"description":"SWIFT/BIC code (optional)"}},"required":["accountName","accountNumber","bankName"],"nullable":true},"notes":{"type":"string","nullable":true,"description":"Additional notes for the payout"},"ordersIncluded":{"type":"array","items":{"type":"string"},"description":"Array of order IDs included in this payout"},"processedBy":{"type":"string","format":"uuid","nullable":true,"description":"ID of admin who processed the payout"},"processedAt":{"type":"string","format":"date-time","nullable":true,"description":"When the payout was processed"},"requestedAt":{"type":"string","format":"date-time","description":"When the payout was requested"},"createdAt":{"type":"string","format":"date-time","description":"Record creation timestamp"},"updatedAt":{"type":"string","format":"date-time","description":"Record last update timestamp"}}}},"total":{"type":"number","description":"Total number of payouts matching the filters"},"page":{"type":"number","description":"Current page number"},"limit":{"type":"number","description":"Items per page"},"totalPages":{"type":"number","description":"Total number of pages"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/payouts/summary":{"get":{"summary":"Get payout summary","tags":["payouts"],"description":"Retrieve a summary of payouts for a company including total payouts, pending amounts, completed amounts, and other statistics. Company managers and vendors can only view their own company summary.","parameters":[{"schema":{"type":"string","format":"uuid"},"in":"query","name":"companyId","required":false,"description":"Company ID to get summary for (optional for admins, ignored for company managers/vendors)"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Payout summary retrieved successfully","content":{"application/json":{"schema":{"description":"Payout summary retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"summary":{"type":"object","properties":{"totalPayouts":{"type":"number","description":"Total number of payouts"},"totalAmount":{"type":"number","description":"Total amount of all payouts in IQD"},"pendingPayouts":{"type":"number","description":"Number of pending payouts"},"pendingAmount":{"type":"number","description":"Total amount of pending payouts in IQD"},"completedPayouts":{"type":"number","description":"Number of completed payouts"},"completedAmount":{"type":"number","description":"Total amount of completed payouts in IQD"},"averagePayoutAmount":{"type":"number","description":"Average payout amount in IQD"},"lastPayoutDate":{"type":"string","format":"date-time","nullable":true,"description":"Date of the last payout"},"nextScheduledPayout":{"type":"string","format":"date-time","nullable":true,"description":"Date of the next scheduled payout"}}}}}}}},"400":{"description":"Bad request - company ID is required","content":{"application/json":{"schema":{"description":"Bad request - company ID is required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - trying to access another company summary","content":{"application/json":{"schema":{"description":"Forbidden - trying to access another company summary","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/payouts/{id}/status":{"patch":{"summary":"Update payout status","tags":["payouts"],"description":"Update the status of a payout request. Only accessible by ADMIN and SUPER_ADMIN roles. Used to approve, process, complete, or reject payout requests.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["status"],"properties":{"status":{"type":"string","enum":["PENDING","PROCESSING","COMPLETED","FAILED","CANCELLED"],"description":"New status for the payout"},"notes":{"type":"string","description":"Admin notes about the status change"}}}}},"required":true},"parameters":[{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true,"description":"Payout ID to update"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Payout status updated successfully","content":{"application/json":{"schema":{"description":"Payout status updated successfully","type":"object","properties":{"success":{"type":"boolean"},"payout":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"Unique payout identifier"},"companyId":{"type":"string","format":"uuid","description":"Company ID associated with the payout"},"amount":{"type":"number","description":"Payout amount in IQD"},"method":{"type":"string","enum":["BANK_TRANSFER","CASH","WALLET","CHECK"],"description":"Payment method for the payout"},"status":{"type":"string","enum":["PENDING","PROCESSING","COMPLETED","FAILED","CANCELLED"],"description":"Status of the payout request"},"bankDetails":{"type":"object","properties":{"accountName":{"type":"string","description":"Bank account holder name"},"accountNumber":{"type":"string","description":"Bank account number"},"bankName":{"type":"string","description":"Name of the bank"},"iban":{"type":"string","nullable":true,"description":"International Bank Account Number (optional)"},"swiftCode":{"type":"string","nullable":true,"description":"SWIFT/BIC code (optional)"}},"required":["accountName","accountNumber","bankName"],"nullable":true},"notes":{"type":"string","nullable":true,"description":"Additional notes for the payout"},"ordersIncluded":{"type":"array","items":{"type":"string"},"description":"Array of order IDs included in this payout"},"processedBy":{"type":"string","format":"uuid","nullable":true,"description":"ID of admin who processed the payout"},"processedAt":{"type":"string","format":"date-time","nullable":true,"description":"When the payout was processed"},"requestedAt":{"type":"string","format":"date-time","description":"When the payout was requested"},"createdAt":{"type":"string","format":"date-time","description":"Record creation timestamp"},"updatedAt":{"type":"string","format":"date-time","description":"Record last update timestamp"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - status is required or invalid status transition","content":{"application/json":{"schema":{"description":"Bad request - status is required or invalid status transition","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - only admins can update payout status","content":{"application/json":{"schema":{"description":"Forbidden - only admins can update payout status","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"404":{"description":"Payout not found","content":{"application/json":{"schema":{"description":"Payout not found","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/payouts/{id}":{"delete":{"summary":"Cancel payout","tags":["payouts"],"description":"Cancel a pending payout request. Only the requesting user or admins can cancel a payout. Requires a cancellation reason.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["reason"],"properties":{"reason":{"type":"string","minLength":1,"description":"Reason for cancelling the payout request"}}}}},"required":true},"parameters":[{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true,"description":"Payout ID to cancel"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Payout cancelled successfully","content":{"application/json":{"schema":{"description":"Payout cancelled successfully","type":"object","properties":{"success":{"type":"boolean"},"payout":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"Unique payout identifier"},"companyId":{"type":"string","format":"uuid","description":"Company ID associated with the payout"},"amount":{"type":"number","description":"Payout amount in IQD"},"method":{"type":"string","enum":["BANK_TRANSFER","CASH","WALLET","CHECK"],"description":"Payment method for the payout"},"status":{"type":"string","enum":["PENDING","PROCESSING","COMPLETED","FAILED","CANCELLED"],"description":"Status of the payout request"},"bankDetails":{"type":"object","properties":{"accountName":{"type":"string","description":"Bank account holder name"},"accountNumber":{"type":"string","description":"Bank account number"},"bankName":{"type":"string","description":"Name of the bank"},"iban":{"type":"string","nullable":true,"description":"International Bank Account Number (optional)"},"swiftCode":{"type":"string","nullable":true,"description":"SWIFT/BIC code (optional)"}},"required":["accountName","accountNumber","bankName"],"nullable":true},"notes":{"type":"string","nullable":true,"description":"Additional notes for the payout"},"ordersIncluded":{"type":"array","items":{"type":"string"},"description":"Array of order IDs included in this payout"},"processedBy":{"type":"string","format":"uuid","nullable":true,"description":"ID of admin who processed the payout"},"processedAt":{"type":"string","format":"date-time","nullable":true,"description":"When the payout was processed"},"requestedAt":{"type":"string","format":"date-time","description":"When the payout was requested"},"createdAt":{"type":"string","format":"date-time","description":"Record creation timestamp"},"updatedAt":{"type":"string","format":"date-time","description":"Record last update timestamp"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - cancellation reason is required or payout cannot be cancelled","content":{"application/json":{"schema":{"description":"Bad request - cancellation reason is required or payout cannot be cancelled","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - no permission to cancel this payout","content":{"application/json":{"schema":{"description":"Forbidden - no permission to cancel this payout","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"404":{"description":"Payout not found","content":{"application/json":{"schema":{"description":"Payout not found","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/payouts/report":{"post":{"summary":"Generate payout report","tags":["payouts"],"description":"Generate a detailed payout report for a specific period. Includes order details, revenue breakdown, commission calculations, and payout amounts. Company managers and vendors can only generate reports for their own company.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["startDate","endDate"],"properties":{"companyId":{"type":"string","format":"uuid","description":"Company ID to generate report for (optional for admins)"},"startDate":{"type":"string","format":"date","description":"Report start date (YYYY-MM-DD)"},"endDate":{"type":"string","format":"date","description":"Report end date (YYYY-MM-DD)"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Payout report generated successfully","content":{"application/json":{"schema":{"description":"Payout report generated successfully","type":"object","properties":{"success":{"type":"boolean"},"report":{"type":"object","properties":{"company":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"email":{"type":"string"},"commissionRate":{"type":"number"}}},"period":{"type":"object","properties":{"start":{"type":"string","format":"date-time"},"end":{"type":"string","format":"date-time"}}},"summary":{"type":"object","properties":{"totalOrders":{"type":"number","description":"Total number of completed orders"},"totalRevenue":{"type":"number","description":"Total revenue in IQD"},"totalCommission":{"type":"number","description":"Total commission deducted in IQD"},"totalPayout":{"type":"number","description":"Total payout amount in IQD"}}},"orders":{"type":"array","items":{"type":"object","properties":{"orderId":{"type":"string"},"date":{"type":"string","format":"date-time"},"revenue":{"type":"number"},"commission":{"type":"number"},"payout":{"type":"number"},"status":{"type":"string"}}}},"generatedAt":{"type":"string","format":"date-time"}}}}}}}},"400":{"description":"Bad request - start date and end date are required","content":{"application/json":{"schema":{"description":"Bad request - start date and end date are required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - trying to generate report for another company","content":{"application/json":{"schema":{"description":"Forbidden - trying to generate report for another company","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"404":{"description":"Company not found","content":{"application/json":{"schema":{"description":"Company not found","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/payouts/schedule":{"post":{"summary":"Schedule automatic payouts","tags":["payouts"],"description":"Set up automatic payout scheduling for a company. Only accessible by COMPANY_MANAGER, ADMIN, and SUPER_ADMIN roles. Payouts can be scheduled weekly, biweekly, or monthly.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["schedule"],"properties":{"schedule":{"type":"string","enum":["WEEKLY","BIWEEKLY","MONTHLY"],"description":"Payout schedule frequency"},"companyId":{"type":"string","format":"uuid","description":"Company ID to set schedule for (optional for admins)"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Automatic payout scheduled successfully","content":{"application/json":{"schema":{"description":"Automatic payout scheduled successfully","type":"object","properties":{"success":{"type":"boolean"},"schedule":{"type":"object","properties":{"companyId":{"type":"string","format":"uuid"},"schedule":{"type":"string","enum":["WEEKLY","BIWEEKLY","MONTHLY"]},"enabled":{"type":"boolean"},"nextPayoutDate":{"type":"string","format":"date-time","description":"Next scheduled payout date"},"createdAt":{"type":"string","format":"date-time"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - invalid schedule value or company ID required","content":{"application/json":{"schema":{"description":"Bad request - invalid schedule value or company ID required","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - only company managers and admins can schedule automatic payouts","content":{"application/json":{"schema":{"description":"Forbidden - only company managers and admins can schedule automatic payouts","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/payouts/pending":{"get":{"summary":"Get pending payouts for review","tags":["payouts"],"description":"Retrieve all pending payout requests that need admin review. Only accessible by ADMIN and SUPER_ADMIN roles. Used for the admin dashboard to review and approve/reject payout requests.","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Pending payouts retrieved successfully","content":{"application/json":{"schema":{"description":"Pending payouts retrieved successfully","type":"object","properties":{"success":{"type":"boolean"},"payouts":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"Unique payout identifier"},"companyId":{"type":"string","format":"uuid","description":"Company ID associated with the payout"},"amount":{"type":"number","description":"Payout amount in IQD"},"method":{"type":"string","enum":["BANK_TRANSFER","CASH","WALLET","CHECK"],"description":"Payment method for the payout"},"status":{"type":"string","enum":["PENDING","PROCESSING","COMPLETED","FAILED","CANCELLED"],"description":"Status of the payout request"},"bankDetails":{"type":"object","properties":{"accountName":{"type":"string","description":"Bank account holder name"},"accountNumber":{"type":"string","description":"Bank account number"},"bankName":{"type":"string","description":"Name of the bank"},"iban":{"type":"string","nullable":true,"description":"International Bank Account Number (optional)"},"swiftCode":{"type":"string","nullable":true,"description":"SWIFT/BIC code (optional)"}},"required":["accountName","accountNumber","bankName"],"nullable":true},"notes":{"type":"string","nullable":true,"description":"Additional notes for the payout"},"ordersIncluded":{"type":"array","items":{"type":"string"},"description":"Array of order IDs included in this payout"},"processedBy":{"type":"string","format":"uuid","nullable":true,"description":"ID of admin who processed the payout"},"processedAt":{"type":"string","format":"date-time","nullable":true,"description":"When the payout was processed"},"requestedAt":{"type":"string","format":"date-time","description":"When the payout was requested"},"createdAt":{"type":"string","format":"date-time","description":"Record creation timestamp"},"updatedAt":{"type":"string","format":"date-time","description":"Record last update timestamp"},"company":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"email":{"type":"string"}},"description":"Company information"}}}},"total":{"type":"number","description":"Total number of pending payouts"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - only admins can view pending payouts","content":{"application/json":{"schema":{"description":"Forbidden - only admins can view pending payouts","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/payouts/bulk-approve":{"post":{"summary":"Bulk approve payouts","tags":["payouts"],"description":"Approve multiple pending payout requests at once. Only accessible by ADMIN and SUPER_ADMIN roles. All specified payouts will be moved to PROCESSING status.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["payoutIds"],"properties":{"payoutIds":{"type":"array","items":{"type":"string","format":"uuid"},"minItems":1,"description":"Array of payout IDs to approve"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Payouts approved successfully","content":{"application/json":{"schema":{"description":"Payouts approved successfully","type":"object","properties":{"success":{"type":"boolean"},"approved":{"type":"number","description":"Number of payouts approved"},"payouts":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"Unique payout identifier"},"companyId":{"type":"string","format":"uuid","description":"Company ID associated with the payout"},"amount":{"type":"number","description":"Payout amount in IQD"},"method":{"type":"string","enum":["BANK_TRANSFER","CASH","WALLET","CHECK"],"description":"Payment method for the payout"},"status":{"type":"string","enum":["PENDING","PROCESSING","COMPLETED","FAILED","CANCELLED"],"description":"Status of the payout request"},"bankDetails":{"type":"object","properties":{"accountName":{"type":"string","description":"Bank account holder name"},"accountNumber":{"type":"string","description":"Bank account number"},"bankName":{"type":"string","description":"Name of the bank"},"iban":{"type":"string","nullable":true,"description":"International Bank Account Number (optional)"},"swiftCode":{"type":"string","nullable":true,"description":"SWIFT/BIC code (optional)"}},"required":["accountName","accountNumber","bankName"],"nullable":true},"notes":{"type":"string","nullable":true,"description":"Additional notes for the payout"},"ordersIncluded":{"type":"array","items":{"type":"string"},"description":"Array of order IDs included in this payout"},"processedBy":{"type":"string","format":"uuid","nullable":true,"description":"ID of admin who processed the payout"},"processedAt":{"type":"string","format":"date-time","nullable":true,"description":"When the payout was processed"},"requestedAt":{"type":"string","format":"date-time","description":"When the payout was requested"},"createdAt":{"type":"string","format":"date-time","description":"Record creation timestamp"},"updatedAt":{"type":"string","format":"date-time","description":"Record last update timestamp"}}},"description":"List of approved payouts"},"message":{"type":"string"}}}}}},"400":{"description":"Bad request - payout IDs array is required or invalid","content":{"application/json":{"schema":{"description":"Bad request - payout IDs array is required or invalid","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - invalid or missing token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing token","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - only admins can bulk approve payouts","content":{"application/json":{"schema":{"description":"Forbidden - only admins can bulk approve payouts","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/payouts/validate-bank":{"post":{"summary":"Validate bank details","tags":["payouts"],"description":"Validate bank account details before submitting a payout request. This is a public endpoint that does not require authentication. Useful for validating bank details in forms.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["bankDetails"],"properties":{"bankDetails":{"type":"object","required":["accountName","accountNumber","bankName"],"properties":{"accountName":{"type":"string","minLength":2,"description":"Bank account holder name"},"accountNumber":{"type":"string","minLength":5,"description":"Bank account number"},"bankName":{"type":"string","minLength":2,"description":"Name of the bank"},"iban":{"type":"string","nullable":true,"description":"International Bank Account Number (optional)"},"swiftCode":{"type":"string","nullable":true,"description":"SWIFT/BIC code (optional)"}}}}}}},"required":true},"responses":{"200":{"description":"Bank details validation result","content":{"application/json":{"schema":{"description":"Bank details validation result","type":"object","properties":{"success":{"type":"boolean"},"valid":{"type":"boolean","description":"Whether the bank details are valid"},"message":{"type":"string","description":"Validation message"}}}}}},"400":{"description":"Bad request - invalid request body","content":{"application/json":{"schema":{"description":"Bad request - invalid request body","type":"object","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/delivery/orders/{orderId}/status":{"patch":{"summary":"Update order status in delivery workflow","tags":["delivery"],"description":"Updates the delivery status of an order. Vendors and Company Managers can only update orders belonging to their company. Admins can update any order.","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["PENDING","CONFIRMED","PROCESSING","SHIPPED","DELIVERED","CANCELLED","REFUNDED"],"description":"The new order status, e.g. PREPARING, ON_THE_WAY, DELIVERED"},"notes":{"type":"string","description":"Optional notes about the status update, e.g. Customer requested delay"},"estimatedTime":{"type":"string","format":"date-time","description":"Estimated delivery time in ISO 8601 format, e.g. 2024-01-15T14:30:00Z"},"location":{"type":"object","description":"Current location coordinates of the delivery","properties":{"latitude":{"type":"number","description":"Latitude coordinate, e.g. 40.7128"},"longitude":{"type":"number","description":"Longitude coordinate, e.g. -74.0060"}}}},"required":["status"]}}},"required":true},"parameters":[{"schema":{"type":"string"},"in":"path","name":"orderId","required":true,"description":"The unique identifier of the order, e.g. clx1234567890"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Order status updated successfully","content":{"application/json":{"schema":{"type":"object","description":"Order status updated successfully","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"order":{"type":"object","description":"The updated order object","properties":{"id":{"type":"string","description":"Order ID"},"status":{"type":"string","description":"Updated order status"},"updatedAt":{"type":"string","format":"date-time","description":"Timestamp of the update"}}},"message":{"type":"string","description":"Success message"}}}}}},"400":{"description":"Bad request - Invalid status or request body","content":{"application/json":{"schema":{"type":"object","description":"Bad request - Invalid status or request body","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - Missing or invalid authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - Missing or invalid authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - User does not have permission to update this order","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - User does not have permission to update this order","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/delivery/orders/bulk-status":{"patch":{"summary":"Bulk update order statuses","tags":["delivery"],"description":"Updates the status of multiple orders at once. Vendors and Company Managers can only update orders belonging to their company. Useful for batch processing of orders in the same delivery workflow stage.","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"orderIds":{"type":"array","items":{"type":"string"},"description":"Array of order IDs to update, e.g. [\"clx123\", \"clx456\", \"clx789\"]"},"status":{"type":"string","enum":["PENDING","CONFIRMED","PROCESSING","SHIPPED","DELIVERED","CANCELLED","REFUNDED"],"description":"The new status to apply to all orders, e.g. PREPARING, ON_THE_WAY"}},"required":["orderIds","status"]}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Bulk status update completed","content":{"application/json":{"schema":{"type":"object","description":"Bulk status update completed","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"updated":{"type":"number","description":"Number of orders successfully updated"},"failed":{"type":"number","description":"Number of orders that failed to update"},"message":{"type":"string","description":"Summary message of the bulk operation"}}}}}},"400":{"description":"Bad request - Invalid order IDs or status","content":{"application/json":{"schema":{"type":"object","description":"Bad request - Invalid order IDs or status","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - Missing or invalid authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - Missing or invalid authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - User does not have permission to update some orders","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - User does not have permission to update some orders","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/delivery/orders/status/{status}":{"get":{"summary":"Get orders by delivery status","tags":["delivery"],"description":"Retrieves all orders with a specific delivery status. Vendors and Company Managers see only their company orders. Admins can view all orders or filter by company using the companyId query parameter.","parameters":[{"schema":{"type":"string"},"in":"query","name":"companyId","required":false,"description":"Company ID to filter orders (admin only), e.g. clx987654321"},{"schema":{"type":"string","enum":["PENDING","CONFIRMED","PROCESSING","SHIPPED","DELIVERED","CANCELLED","REFUNDED"]},"in":"path","name":"status","required":true,"description":"The order status to filter by, e.g. PENDING, ACCEPTED, PREPARING, ON_THE_WAY, DELIVERED"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Orders retrieved successfully","content":{"application/json":{"schema":{"type":"object","description":"Orders retrieved successfully","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"orders":{"type":"array","description":"List of orders matching the status","items":{"type":"object","properties":{"id":{"type":"string","description":"Order ID"},"status":{"type":"string","description":"Order status"},"createdAt":{"type":"string","format":"date-time","description":"Order creation timestamp"},"user":{"type":"object","description":"Customer information","properties":{"id":{"type":"string","description":"User ID"},"name":{"type":"string","description":"Customer name"},"phone":{"type":"string","description":"Customer phone number"},"address":{"type":"string","description":"Delivery address"}}},"items":{"type":"array","description":"Order items","items":{"type":"object","properties":{"id":{"type":"string","description":"Order item ID"},"quantity":{"type":"number","description":"Item quantity"},"product":{"type":"object","description":"Product details","properties":{"id":{"type":"string","description":"Product ID"},"name":{"type":"string","description":"Product name"},"company":{"type":"object","description":"Company that owns the product","properties":{"id":{"type":"string","description":"Company ID"},"name":{"type":"string","description":"Company name"}}}}}}}}}}}}}}}},"400":{"description":"Bad request - Company ID required for non-admin users without company","content":{"application/json":{"schema":{"type":"object","description":"Bad request - Company ID required for non-admin users without company","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - Missing or invalid authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - Missing or invalid authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","description":"Internal server error","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/delivery/orders/{orderId}/assign-driver":{"post":{"summary":"Assign delivery driver to order","tags":["delivery"],"description":"Assigns a delivery driver to a specific order. Only Admins, Super Admins, and Company Managers can assign drivers. Company Managers can only assign drivers to orders belonging to their company.","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"driverId":{"type":"string","description":"The unique identifier of the driver to assign, e.g. usr9876543210"}},"required":["driverId"]}}},"required":true},"parameters":[{"schema":{"type":"string"},"in":"path","name":"orderId","required":true,"description":"The unique identifier of the order, e.g. clx1234567890"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Driver assigned successfully","content":{"application/json":{"schema":{"type":"object","description":"Driver assigned successfully","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"assignment":{"type":"object","description":"Driver assignment details","properties":{"orderId":{"type":"string","description":"Order ID"},"driverId":{"type":"string","description":"Assigned driver ID"},"assignedAt":{"type":"string","format":"date-time","description":"Assignment timestamp"}}},"message":{"type":"string","description":"Success message"}}}}}},"400":{"description":"Bad request - Invalid order ID or driver ID","content":{"application/json":{"schema":{"type":"object","description":"Bad request - Invalid order ID or driver ID","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - Missing or invalid authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - Missing or invalid authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - User does not have permission to assign drivers","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - User does not have permission to assign drivers","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"404":{"description":"Not found - Order or driver not found","content":{"application/json":{"schema":{"type":"object","description":"Not found - Order or driver not found","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/delivery/orders/{orderId}/cash-collection":{"post":{"summary":"Record cash collection for COD order","tags":["delivery"],"description":"Records cash collection for Cash on Delivery (COD) orders. Vendors and Company Managers can only record collections for orders belonging to their company. The collected amount is stored with the collector information.","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"amount":{"type":"number","minimum":0,"description":"The cash amount collected in the base currency, e.g. 150.50"},"notes":{"type":"string","description":"Optional notes about the collection, e.g. Exact change received"}},"required":["amount"]}}},"required":true},"parameters":[{"schema":{"type":"string"},"in":"path","name":"orderId","required":true,"description":"The unique identifier of the order, e.g. clx1234567890"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Cash collection recorded successfully","content":{"application/json":{"schema":{"type":"object","description":"Cash collection recorded successfully","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"collection":{"type":"object","description":"Cash collection record details","properties":{"id":{"type":"string","description":"Collection record ID"},"orderId":{"type":"string","description":"Associated order ID"},"amount":{"type":"number","description":"Collected amount"},"collectedBy":{"type":"string","description":"ID of user who collected the cash"},"collectedAt":{"type":"string","format":"date-time","description":"Collection timestamp"},"notes":{"type":"string","description":"Collection notes"}}},"message":{"type":"string","description":"Success message"}}}}}},"400":{"description":"Bad request - Invalid amount or order already has collection recorded","content":{"application/json":{"schema":{"type":"object","description":"Bad request - Invalid amount or order already has collection recorded","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - Missing or invalid authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - Missing or invalid authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - User does not have permission to record cash for this order","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - User does not have permission to record cash for this order","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"404":{"description":"Not found - Order not found","content":{"application/json":{"schema":{"type":"object","description":"Not found - Order not found","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/delivery/metrics":{"get":{"summary":"Get delivery metrics","tags":["delivery"],"description":"Retrieves delivery performance metrics for a company. Includes statistics on completed deliveries, average delivery time, success rate, and more. Non-admin users can only view metrics for their own company.","parameters":[{"schema":{"type":"string","enum":["today","week","month"]},"in":"query","name":"period","required":false,"description":"Time period for metrics aggregation, e.g. today, week, or month"},{"schema":{"type":"string"},"in":"query","name":"companyId","required":false,"description":"Company ID to get metrics for (admin only), e.g. clx987654321"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Delivery metrics retrieved successfully","content":{"application/json":{"schema":{"type":"object","description":"Delivery metrics retrieved successfully","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"metrics":{"type":"object","description":"Delivery performance metrics","properties":{"totalOrders":{"type":"number","description":"Total number of orders in the period"},"completedOrders":{"type":"number","description":"Number of successfully delivered orders"},"pendingOrders":{"type":"number","description":"Number of pending orders"},"cancelledOrders":{"type":"number","description":"Number of cancelled orders"},"averageDeliveryTime":{"type":"number","description":"Average delivery time in minutes"},"successRate":{"type":"number","description":"Delivery success rate as percentage, e.g. 95.5"},"totalRevenue":{"type":"number","description":"Total revenue from completed orders"},"cashCollected":{"type":"number","description":"Total cash collected from COD orders"},"ordersByStatus":{"type":"object","description":"Order count breakdown by status","additionalProperties":{"type":"number"}},"ordersByZone":{"type":"object","description":"Order count breakdown by delivery zone","additionalProperties":{"type":"number"}}}}}}}}},"400":{"description":"Bad request - Company ID required","content":{"application/json":{"schema":{"type":"object","description":"Bad request - Company ID required","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"401":{"description":"Unauthorized - Missing or invalid authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - Missing or invalid authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"403":{"description":"Forbidden - User can only view metrics for their own company","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - User can only view metrics for their own company","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","description":"Internal server error","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/delivery/track/{orderId}":{"get":{"summary":"Track delivery status","tags":["delivery"],"description":"Public endpoint to track delivery status of an order. Optionally verify with phone number for additional security. Returns current status, estimated delivery time, and tracking history.","parameters":[{"schema":{"type":"string"},"in":"query","name":"phone","required":false,"description":"Phone number for verification (must match order customer phone), e.g. +1234567890"},{"schema":{"type":"string"},"in":"path","name":"orderId","required":true,"description":"The unique identifier of the order to track, e.g. clx1234567890"}],"responses":{"200":{"description":"Tracking information retrieved successfully","content":{"application/json":{"schema":{"type":"object","description":"Tracking information retrieved successfully","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"tracking":{"type":"object","description":"Delivery tracking information","properties":{"orderId":{"type":"string","description":"Order ID"},"status":{"type":"string","description":"Current order status"},"estimatedDelivery":{"type":"string","format":"date-time","description":"Estimated delivery time"},"currentLocation":{"type":"object","description":"Current delivery location (if available)","properties":{"latitude":{"type":"number","description":"Latitude coordinate"},"longitude":{"type":"number","description":"Longitude coordinate"},"updatedAt":{"type":"string","format":"date-time","description":"Location update timestamp"}}},"history":{"type":"array","description":"Status history timeline","items":{"type":"object","properties":{"status":{"type":"string","description":"Status at this point"},"timestamp":{"type":"string","format":"date-time","description":"When status changed"},"notes":{"type":"string","description":"Optional notes for this status"}}}},"driver":{"type":"object","description":"Assigned driver information (if available)","properties":{"name":{"type":"string","description":"Driver name"},"phone":{"type":"string","description":"Driver phone number"}}}}}}}}}},"404":{"description":"Not found - Order not found or phone number does not match","content":{"application/json":{"schema":{"type":"object","description":"Not found - Order not found or phone number does not match","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","description":"Internal server error","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/delivery/active":{"get":{"summary":"Get active deliveries dashboard","tags":["delivery"],"description":"Retrieves all active deliveries grouped by status (accepted, preparing, on_the_way). Provides a real-time dashboard view for managing ongoing deliveries. Vendors and Company Managers see only their company orders.","parameters":[{"schema":{"type":"string"},"in":"query","name":"companyId","required":false,"description":"Company ID to filter active deliveries (admin only), e.g. clx987654321"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Active deliveries retrieved successfully","content":{"application/json":{"schema":{"type":"object","description":"Active deliveries retrieved successfully","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"activeOrders":{"type":"object","description":"Orders grouped by status","properties":{"accepted":{"type":"array","description":"Orders that have been accepted","items":{"type":"object","properties":{"id":{"type":"string","description":"Order ID"},"status":{"type":"string","description":"Order status"},"createdAt":{"type":"string","format":"date-time","description":"Order creation timestamp"},"user":{"type":"object","description":"Customer information","properties":{"id":{"type":"string","description":"User ID"},"name":{"type":"string","description":"Customer name"},"phone":{"type":"string","description":"Customer phone"},"address":{"type":"string","description":"Delivery address"},"zone":{"type":"string","description":"Delivery zone"}}},"items":{"type":"array","description":"Order items","items":{"type":"object","properties":{"id":{"type":"string","description":"Order item ID"},"quantity":{"type":"number","description":"Item quantity"},"product":{"type":"object","properties":{"id":{"type":"string","description":"Product ID"},"name":{"type":"string","description":"Product name"},"price":{"type":"number","description":"Product price"},"company":{"type":"object","properties":{"id":{"type":"string","description":"Company ID"},"name":{"type":"string","description":"Company name"}}}}}}}}}}},"preparing":{"type":"array","description":"Orders being prepared","items":{"type":"object"}},"onTheWay":{"type":"array","description":"Orders out for delivery","items":{"type":"object"}}}},"summary":{"type":"object","description":"Summary counts of active orders","properties":{"total":{"type":"number","description":"Total active orders"},"accepted":{"type":"number","description":"Count of accepted orders"},"preparing":{"type":"number","description":"Count of orders being prepared"},"onTheWay":{"type":"number","description":"Count of orders out for delivery"}}}}}}}},"401":{"description":"Unauthorized - Missing or invalid authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - Missing or invalid authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","description":"Internal server error","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error message"}}}}}}}}},"/api/settlements/create":{"post":{"summary":"Create settlement for a period","tags":["settlements"],"description":"Creates a new settlement record for a company within a specified date range. Admins can create settlements for any company, while company managers can only create settlements for their own company. The settlement includes all orders within the period.","requestBody":{"content":{"application/json":{"schema":{"type":"object","description":"Settlement creation parameters","properties":{"companyId":{"type":"string","description":"UUID of the company to create settlement for. Optional for company managers (defaults to their own company), e.g. \"550e8400-e29b-41d4-a716-446655440000\""},"periodStart":{"type":"string","format":"date-time","description":"Start date/time of the settlement period in ISO 8601 format, e.g. \"2024-01-01T00:00:00Z\""},"periodEnd":{"type":"string","format":"date-time","description":"End date/time of the settlement period in ISO 8601 format, e.g. \"2024-01-31T23:59:59Z\""}},"required":["periodStart","periodEnd"]}}},"required":true,"description":"Settlement creation parameters"},"security":[{"bearerAuth":[]}],"responses":{"201":{"description":"Settlement created successfully","content":{"application/json":{"schema":{"type":"object","description":"Settlement created successfully","properties":{"success":{"type":"boolean","description":"Operation success status"},"settlement":{"type":"object","description":"The created settlement record","properties":{"id":{"type":"string","description":"Settlement UUID"},"companyId":{"type":"string","description":"Company UUID"},"periodStart":{"type":"string","format":"date-time","description":"Settlement period start"},"periodEnd":{"type":"string","format":"date-time","description":"Settlement period end"},"totalSales":{"type":"number","description":"Total sales amount in IQD"},"platformFee":{"type":"number","description":"Platform fee amount in IQD"},"netAmount":{"type":"number","description":"Net amount payable in IQD"},"status":{"type":"string","description":"Settlement status: PENDING, VERIFIED, PAID"},"createdAt":{"type":"string","format":"date-time","description":"Creation timestamp"}}},"message":{"type":"string","description":"Success message"}}}}}},"400":{"description":"Bad request - validation error or missing required fields","content":{"application/json":{"schema":{"type":"object","description":"Bad request - validation error or missing required fields","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - invalid or missing authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"403":{"description":"Forbidden - user does not have permission to create settlements","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - user does not have permission to create settlements","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","description":"Internal server error","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}}}}},"/api/settlements/summary":{"get":{"summary":"Get settlement summary","tags":["settlements"],"description":"Retrieves a comprehensive settlement summary for a company including total sales, platform fees, cash collections, pending amounts, and cash flow data. Non-admin users can only view their own company's summary.","parameters":[{"schema":{"type":"string"},"in":"query","name":"companyId","required":false,"description":"UUID of the company to get summary for. Optional for non-admins (defaults to their own company), e.g. \"550e8400-e29b-41d4-a716-446655440000\""},{"schema":{"type":"string","format":"date"},"in":"query","name":"startDate","required":false,"description":"Start date for the summary period in YYYY-MM-DD format, e.g. \"2024-01-01\""},{"schema":{"type":"string","format":"date"},"in":"query","name":"endDate","required":false,"description":"End date for the summary period in YYYY-MM-DD format, e.g. \"2024-01-31\""}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Settlement summary retrieved successfully","content":{"application/json":{"schema":{"type":"object","description":"Settlement summary retrieved successfully","properties":{"success":{"type":"boolean","description":"Operation success status"},"summary":{"type":"object","description":"The settlement summary data","properties":{"companyId":{"type":"string","description":"Company UUID"},"companyName":{"type":"string","description":"Company name"},"period":{"type":"object","description":"Summary period details","properties":{"start":{"type":"string","format":"date-time","description":"Period start date"},"end":{"type":"string","format":"date-time","description":"Period end date"}}},"totalSales":{"type":"number","description":"Total sales amount in IQD"},"totalPlatformFees":{"type":"number","description":"Total platform fees in IQD"},"totalCashCollected":{"type":"number","description":"Total cash collected in IQD"},"pendingCashAmount":{"type":"number","description":"Pending cash collection amount in IQD"},"netPayable":{"type":"number","description":"Net amount payable to company in IQD"},"cashFlow":{"type":"object","description":"Cash flow breakdown","properties":{"inflow":{"type":"number","description":"Total cash inflow in IQD"},"outflow":{"type":"number","description":"Total cash outflow in IQD"},"balance":{"type":"number","description":"Net cash balance in IQD"}}}}}}}}}},"400":{"description":"Bad request - missing company ID","content":{"application/json":{"schema":{"type":"object","description":"Bad request - missing company ID","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - invalid or missing authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"403":{"description":"Forbidden - user does not have permission to view this company's settlements","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - user does not have permission to view this company's settlements","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","description":"Internal server error","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}}}}},"/api/settlements/reconcile-cash":{"post":{"summary":"Reconcile cash collections for a period","tags":["settlements"],"description":"Reconciles cash collections for a company within a specified date range. This process verifies collected cash against order records and identifies any discrepancies. Only admins and company managers can perform reconciliation.","requestBody":{"content":{"application/json":{"schema":{"type":"object","description":"Cash reconciliation parameters","properties":{"companyId":{"type":"string","description":"UUID of the company to reconcile cash for. Optional for company managers (defaults to their own company), e.g. \"550e8400-e29b-41d4-a716-446655440000\""},"startDate":{"type":"string","format":"date-time","description":"Start date/time of the reconciliation period in ISO 8601 format, e.g. \"2024-01-01T00:00:00Z\""},"endDate":{"type":"string","format":"date-time","description":"End date/time of the reconciliation period in ISO 8601 format, e.g. \"2024-01-31T23:59:59Z\""}},"required":["startDate","endDate"]}}},"required":true,"description":"Cash reconciliation parameters"},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Cash reconciliation completed successfully","content":{"application/json":{"schema":{"type":"object","description":"Cash reconciliation completed successfully","properties":{"success":{"type":"boolean","description":"Operation success status"},"reconciliations":{"type":"array","description":"List of reconciliation records","items":{"type":"object","properties":{"orderId":{"type":"string","description":"Order UUID"},"orderNumber":{"type":"string","description":"Order reference number"},"expectedAmount":{"type":"number","description":"Expected cash amount in IQD"},"collectedAmount":{"type":"number","description":"Actual collected amount in IQD"},"discrepancy":{"type":"number","description":"Difference between expected and collected in IQD"},"status":{"type":"string","description":"Reconciliation status: MATCHED, SHORTAGE, OVERAGE"},"collectedAt":{"type":"string","format":"date-time","description":"Collection timestamp"}}}},"total":{"type":"integer","description":"Total number of reconciliation records"},"message":{"type":"string","description":"Success message"}}}}}},"400":{"description":"Bad request - missing required fields","content":{"application/json":{"schema":{"type":"object","description":"Bad request - missing required fields","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - invalid or missing authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"403":{"description":"Forbidden - user does not have permission to reconcile cash","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - user does not have permission to reconcile cash","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","description":"Internal server error","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}}}}},"/api/settlements/cash-collected":{"post":{"summary":"Mark cash as collected for an order","tags":["settlements"],"description":"Records cash payment collection for a specific order. Vendors and company managers can only mark cash collected for orders containing their products. Admins can mark cash for any order.","requestBody":{"content":{"application/json":{"schema":{"type":"object","description":"Cash collection details","properties":{"orderId":{"type":"string","description":"UUID of the order to mark cash collected for, e.g. \"550e8400-e29b-41d4-a716-446655440000\""},"amount":{"type":"number","minimum":0,"description":"Amount of cash collected in IQD, e.g. 50000"}},"required":["orderId","amount"]}}},"required":true,"description":"Cash collection details"},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Cash collection marked successfully","content":{"application/json":{"schema":{"type":"object","description":"Cash collection marked successfully","properties":{"success":{"type":"boolean","description":"Operation success status"},"message":{"type":"string","description":"Success message"}}}}}},"400":{"description":"Bad request - invalid order ID or amount","content":{"application/json":{"schema":{"type":"object","description":"Bad request - invalid order ID or amount","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - invalid or missing authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"403":{"description":"Forbidden - user does not have permission to mark cash for this order","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - user does not have permission to mark cash for this order","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"404":{"description":"Order not found","content":{"application/json":{"schema":{"type":"object","description":"Order not found","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","description":"Internal server error","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}}}}},"/api/settlements/pending-cash":{"get":{"summary":"Get pending cash collections","tags":["settlements"],"description":"Retrieves a list of orders with pending cash collections for a company. Shows orders where cash payment has not yet been marked as collected. Non-admin users can only view pending cash for their own company.","parameters":[{"schema":{"type":"string"},"in":"query","name":"companyId","required":false,"description":"UUID of the company to get pending cash for. Optional for non-admins (defaults to their own company), e.g. \"550e8400-e29b-41d4-a716-446655440000\""}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Pending cash collections retrieved successfully","content":{"application/json":{"schema":{"type":"object","description":"Pending cash collections retrieved successfully","properties":{"success":{"type":"boolean","description":"Operation success status"},"pendingCollections":{"type":"array","description":"List of orders with pending cash collections","items":{"type":"object","properties":{"orderId":{"type":"string","description":"Order UUID"},"orderNumber":{"type":"string","description":"Order reference number"},"orderAmount":{"type":"number","description":"Total order amount in IQD"},"customerName":{"type":"string","description":"Customer name"},"orderDate":{"type":"string","format":"date-time","description":"Order creation date"},"dueDate":{"type":"string","format":"date-time","description":"Payment due date"}}}},"total":{"type":"integer","description":"Total number of pending collections"},"totalAmount":{"type":"number","description":"Total pending amount in IQD"}}}}}},"400":{"description":"Bad request - missing company ID","content":{"application/json":{"schema":{"type":"object","description":"Bad request - missing company ID","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - invalid or missing authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"403":{"description":"Forbidden - user does not have permission to view pending cash for this company","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - user does not have permission to view pending cash for this company","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","description":"Internal server error","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}}}}},"/api/settlements/daily":{"post":{"summary":"Process daily settlement","tags":["settlements"],"description":"Processes and creates a daily settlement record for a company. This aggregates all completed orders from the current day, calculates platform fees, and generates a settlement record. Only admins and company managers can process daily settlements.","requestBody":{"content":{"application/json":{"schema":{"type":"object","description":"Daily settlement parameters","properties":{"companyId":{"type":"string","description":"UUID of the company to process daily settlement for. Optional for company managers (defaults to their own company), e.g. \"550e8400-e29b-41d4-a716-446655440000\""}}}}},"description":"Daily settlement parameters"},"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Daily settlement processed successfully","content":{"application/json":{"schema":{"type":"object","description":"Daily settlement processed successfully","properties":{"success":{"type":"boolean","description":"Operation success status"},"settlement":{"type":"object","description":"The created daily settlement record","properties":{"id":{"type":"string","description":"Settlement UUID"},"companyId":{"type":"string","description":"Company UUID"},"date":{"type":"string","format":"date","description":"Settlement date"},"totalOrders":{"type":"integer","description":"Number of orders included"},"totalSales":{"type":"number","description":"Total sales amount in IQD"},"platformFee":{"type":"number","description":"Platform fee amount in IQD"},"netAmount":{"type":"number","description":"Net amount payable in IQD"},"cashCollected":{"type":"number","description":"Cash collected amount in IQD"},"pendingCash":{"type":"number","description":"Pending cash collection in IQD"},"status":{"type":"string","description":"Settlement status: PENDING, VERIFIED, PAID"},"createdAt":{"type":"string","format":"date-time","description":"Creation timestamp"}}},"message":{"type":"string","description":"Success message"}}}}}},"400":{"description":"Bad request - missing company ID","content":{"application/json":{"schema":{"type":"object","description":"Bad request - missing company ID","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - invalid or missing authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"403":{"description":"Forbidden - user does not have permission to process settlements","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - user does not have permission to process settlements","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","description":"Internal server error","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}}}}},"/api/settlements/{settlementId}/verify":{"patch":{"summary":"Verify and approve settlement","tags":["settlements"],"description":"Verifies and approves a pending settlement. This action confirms that the settlement amounts are correct and authorizes payment to the company. Only administrators can verify settlements.","requestBody":{"content":{"application/json":{"schema":{"type":"object","description":"Verification details","properties":{"notes":{"type":"string","description":"Optional notes or comments for the verification, e.g. \"Verified after reconciliation\""}}}}},"description":"Verification details"},"parameters":[{"schema":{"type":"string"},"in":"path","name":"settlementId","required":true,"description":"UUID of the settlement to verify, e.g. \"550e8400-e29b-41d4-a716-446655440000\""}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Settlement verified successfully","content":{"application/json":{"schema":{"type":"object","description":"Settlement verified successfully","properties":{"success":{"type":"boolean","description":"Operation success status"},"settlement":{"type":"object","description":"The verified settlement record","properties":{"id":{"type":"string","description":"Settlement UUID"},"companyId":{"type":"string","description":"Company UUID"},"periodStart":{"type":"string","format":"date-time","description":"Settlement period start"},"periodEnd":{"type":"string","format":"date-time","description":"Settlement period end"},"totalSales":{"type":"number","description":"Total sales amount in IQD"},"platformFee":{"type":"number","description":"Platform fee amount in IQD"},"netAmount":{"type":"number","description":"Net amount payable in IQD"},"status":{"type":"string","description":"Settlement status: VERIFIED"},"verifiedBy":{"type":"string","description":"UUID of the admin who verified"},"verifiedAt":{"type":"string","format":"date-time","description":"Verification timestamp"},"notes":{"type":"string","description":"Verification notes"}}},"message":{"type":"string","description":"Success message"}}}}}},"400":{"description":"Bad request - settlement already verified or invalid state","content":{"application/json":{"schema":{"type":"object","description":"Bad request - settlement already verified or invalid state","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - invalid or missing authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"403":{"description":"Forbidden - only administrators can verify settlements","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - only administrators can verify settlements","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"404":{"description":"Settlement not found","content":{"application/json":{"schema":{"type":"object","description":"Settlement not found","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","description":"Internal server error","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}}}}},"/api/settlements/history":{"get":{"summary":"Get settlement history","tags":["settlements"],"description":"Retrieves the settlement history for a company, showing past settlements with their status, amounts, and dates. Non-admin users can only view their own company's settlement history. Results are sorted by date in descending order.","parameters":[{"schema":{"type":"string"},"in":"query","name":"companyId","required":false,"description":"UUID of the company to get history for. Optional for non-admins (defaults to their own company), e.g. \"550e8400-e29b-41d4-a716-446655440000\""},{"schema":{"type":"integer","minimum":1,"maximum":100,"default":10},"in":"query","name":"limit","required":false,"description":"Maximum number of settlement records to return, default is 10, max is 100"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Settlement history retrieved successfully","content":{"application/json":{"schema":{"type":"object","description":"Settlement history retrieved successfully","properties":{"success":{"type":"boolean","description":"Operation success status"},"settlements":{"type":"array","description":"List of settlement records","items":{"type":"object","properties":{"id":{"type":"string","description":"Settlement UUID"},"companyId":{"type":"string","description":"Company UUID"},"companyName":{"type":"string","description":"Company name"},"periodStart":{"type":"string","format":"date-time","description":"Settlement period start"},"periodEnd":{"type":"string","format":"date-time","description":"Settlement period end"},"totalSales":{"type":"number","description":"Total sales amount in IQD"},"platformFee":{"type":"number","description":"Platform fee amount in IQD"},"netAmount":{"type":"number","description":"Net amount payable in IQD"},"status":{"type":"string","description":"Settlement status: PENDING, VERIFIED, PAID"},"verifiedAt":{"type":"string","format":"date-time","description":"Verification timestamp if verified"},"paidAt":{"type":"string","format":"date-time","description":"Payment timestamp if paid"},"createdAt":{"type":"string","format":"date-time","description":"Creation timestamp"}}}},"total":{"type":"integer","description":"Total number of settlements returned"}}}}}},"400":{"description":"Bad request - missing company ID","content":{"application/json":{"schema":{"type":"object","description":"Bad request - missing company ID","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - invalid or missing authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"403":{"description":"Forbidden - user does not have permission to view this company's settlements","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - user does not have permission to view this company's settlements","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","description":"Internal server error","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}}}}},"/api/settlements/platform-earnings":{"get":{"summary":"Calculate platform earnings for a period","tags":["settlements"],"description":"Calculates the total platform earnings (commission fees) for a specified date range across all companies. This provides a comprehensive view of platform revenue from transaction fees. Only administrators can access this endpoint.","parameters":[{"schema":{"type":"string","format":"date"},"in":"query","name":"startDate","required":true,"description":"Start date for the earnings period in YYYY-MM-DD format, e.g. \"2024-01-01\""},{"schema":{"type":"string","format":"date"},"in":"query","name":"endDate","required":true,"description":"End date for the earnings period in YYYY-MM-DD format, e.g. \"2024-01-31\""}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Platform earnings calculated successfully","content":{"application/json":{"schema":{"type":"object","description":"Platform earnings calculated successfully","properties":{"success":{"type":"boolean","description":"Operation success status"},"earnings":{"type":"object","description":"Platform earnings breakdown","properties":{"period":{"type":"object","description":"Earnings period","properties":{"start":{"type":"string","format":"date","description":"Period start date"},"end":{"type":"string","format":"date","description":"Period end date"}}},"totalSales":{"type":"number","description":"Total sales volume across all companies in IQD"},"totalPlatformFees":{"type":"number","description":"Total platform fees earned in IQD"},"totalOrders":{"type":"integer","description":"Total number of orders processed"},"averageFeeRate":{"type":"number","description":"Average fee rate as percentage, e.g. 5.5"},"byCompany":{"type":"array","description":"Earnings breakdown by company","items":{"type":"object","properties":{"companyId":{"type":"string","description":"Company UUID"},"companyName":{"type":"string","description":"Company name"},"sales":{"type":"number","description":"Company sales in IQD"},"platformFee":{"type":"number","description":"Platform fee from this company in IQD"},"orderCount":{"type":"integer","description":"Number of orders from this company"}}}}}}}}}}},"400":{"description":"Bad request - missing or invalid date parameters","content":{"application/json":{"schema":{"type":"object","description":"Bad request - missing or invalid date parameters","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - invalid or missing authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"403":{"description":"Forbidden - only administrators can view platform earnings","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - only administrators can view platform earnings","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","description":"Internal server error","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}}}}},"/api/settlements/cash-flow":{"get":{"summary":"Get cash flow report","tags":["settlements"],"description":"Retrieves a detailed cash flow report for a company, showing inflows, outflows, and balance for a specified period. Non-admin users can only view cash flow reports for their own company. Useful for financial planning and reconciliation.","parameters":[{"schema":{"type":"string"},"in":"query","name":"companyId","required":false,"description":"UUID of the company to get cash flow for. Optional for non-admins (defaults to their own company), e.g. \"550e8400-e29b-41d4-a716-446655440000\""},{"schema":{"type":"string","format":"date"},"in":"query","name":"startDate","required":false,"description":"Start date for the cash flow period in YYYY-MM-DD format, e.g. \"2024-01-01\""},{"schema":{"type":"string","format":"date"},"in":"query","name":"endDate","required":false,"description":"End date for the cash flow period in YYYY-MM-DD format, e.g. \"2024-01-31\""}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Cash flow report retrieved successfully","content":{"application/json":{"schema":{"type":"object","description":"Cash flow report retrieved successfully","properties":{"success":{"type":"boolean","description":"Operation success status"},"cashFlow":{"type":"object","description":"Cash flow data","properties":{"inflow":{"type":"number","description":"Total cash inflow (collections) in IQD"},"outflow":{"type":"number","description":"Total cash outflow (payments, fees) in IQD"},"balance":{"type":"number","description":"Net cash balance in IQD"},"pendingCollections":{"type":"number","description":"Pending cash collections in IQD"},"settledAmount":{"type":"number","description":"Total settled amount in IQD"},"unsettledAmount":{"type":"number","description":"Total unsettled amount in IQD"}}},"period":{"type":"object","description":"Report period details","properties":{"start":{"type":"string","format":"date-time","description":"Period start date"},"end":{"type":"string","format":"date-time","description":"Period end date"}}},"company":{"type":"object","description":"Company information","properties":{"id":{"type":"string","description":"Company UUID"},"name":{"type":"string","description":"Company name"}}}}}}}},"400":{"description":"Bad request - missing company ID","content":{"application/json":{"schema":{"type":"object","description":"Bad request - missing company ID","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"type":"object","description":"Unauthorized - invalid or missing authentication token","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"403":{"description":"Forbidden - user does not have permission to view cash flow for this company","content":{"application/json":{"schema":{"type":"object","description":"Forbidden - user does not have permission to view cash flow for this company","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","description":"Internal server error","properties":{"error":{"type":"string","description":"Error type"},"message":{"type":"string","description":"Error details"}}}}}}}}},"/api/internal/login":{"post":{"summary":"Internal team login","tags":["internal"],"description":"Login for Lilium internal team (lilium@lilium.iq)","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string","format":"email","description":"Use: lilium@lilium.iq"},"password":{"type":"string","description":"Use: lilium@123"}}}}},"required":true},"responses":{"200":{"description":"Successful login","content":{"application/json":{"schema":{"description":"Successful login","type":"object","properties":{"success":{"type":"boolean"},"authenticated":{"type":"boolean"},"token":{"type":"string"},"message":{"type":"string"}}}}}},"401":{"description":"Invalid credentials","content":{"application/json":{"schema":{"description":"Invalid credentials","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/internal/users/vendor":{"post":{"summary":"Create vendor account","tags":["internal"],"description":"Create a new vendor account for dashboard access","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["email","name","companyId"],"properties":{"email":{"type":"string","format":"email"},"name":{"type":"string","minLength":2},"password":{"type":"string","minLength":6,"nullable":true,"description":"Auto-generated if not provided"},"companyId":{"type":"string","format":"uuid"},"phone":{"type":"string","nullable":true},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA","SADR_CITY","KADHMIYA","ADHAMIYA","MANSOUR","ZAFARANIYA","KARRADA","NEW_BAGHDAD","AL_RASHID"]},"nullable":true}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"201":{"description":"Vendor created successfully","content":{"application/json":{"schema":{"description":"Vendor created successfully","type":"object","properties":{"success":{"type":"boolean"},"user":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"name":{"type":"string"},"role":{"type":"string"},"companyId":{"type":"string"}}},"credentials":{"type":"object","properties":{"email":{"type":"string"},"password":{"type":"string"},"loginUrl":{"type":"string"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request","content":{"application/json":{"schema":{"description":"Bad request","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/internal/users/company-manager":{"post":{"summary":"Create company manager account","tags":["internal"],"description":"Create a new company manager account for dashboard access. Company managers have permissions to manage vendors and products within their assigned company.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["email","name","companyId"],"properties":{"email":{"type":"string","format":"email","description":"Company manager email address, e.g. manager@company.com"},"name":{"type":"string","minLength":2,"description":"Full name of the company manager, e.g. John Doe"},"password":{"type":"string","minLength":6,"nullable":true,"description":"Account password. Auto-generated if not provided"},"companyId":{"type":"string","format":"uuid","description":"UUID of the company this manager will be assigned to"},"phone":{"type":"string","nullable":true,"description":"Contact phone number, e.g. +964-770-123-4567"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA","SADR_CITY","KADHMIYA","ADHAMIYA","MANSOUR","ZAFARANIYA","KARRADA","NEW_BAGHDAD","AL_RASHID"]},"nullable":true,"description":"Array of zones the manager can operate in"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"201":{"description":"Company manager created successfully","content":{"application/json":{"schema":{"description":"Company manager created successfully","type":"object","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"user":{"type":"object","properties":{"id":{"type":"string","description":"Unique identifier of the created user"},"email":{"type":"string","description":"Email address of the company manager"},"name":{"type":"string","description":"Full name of the company manager"},"role":{"type":"string","description":"User role, will be COMPANY_MANAGER"},"companyId":{"type":"string","description":"UUID of the assigned company"}}},"credentials":{"type":"object","properties":{"email":{"type":"string","description":"Login email for the account"},"password":{"type":"string","description":"Password for the account (plain text, share securely)"},"loginUrl":{"type":"string","description":"URL where the manager can login"}}},"message":{"type":"string","description":"Success message with instructions"}}}}}},"400":{"description":"Bad request - validation error or email already exists","content":{"application/json":{"schema":{"description":"Bad request - validation error or email already exists","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Detailed error message"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing authentication token","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authentication error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authorization error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Server error message"}}}}}}}}},"/api/internal/users/shop-owner":{"post":{"summary":"Create shop owner account","tags":["internal"],"description":"Create a new shop owner account for mobile app access","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["email","name","businessName","phone","zones"],"properties":{"email":{"type":"string","format":"email"},"name":{"type":"string","minLength":2},"businessName":{"type":"string","minLength":2},"phone":{"type":"string","pattern":"^[0-9+\\-\\s()]+$"},"password":{"type":"string","minLength":6,"nullable":true,"description":"Auto-generated if not provided"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA","SADR_CITY","KADHMIYA","ADHAMIYA","MANSOUR","ZAFARANIYA","KARRADA","NEW_BAGHDAD","AL_RASHID"]},"minItems":1},"address":{"type":"string","nullable":true}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"201":{"description":"Shop owner created successfully","content":{"application/json":{"schema":{"description":"Shop owner created successfully","type":"object","properties":{"success":{"type":"boolean"},"user":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"name":{"type":"string"},"businessName":{"type":"string"},"phone":{"type":"string"},"role":{"type":"string"},"zones":{"type":"array","items":{"type":"string"}}}},"credentials":{"type":"object","properties":{"email":{"type":"string"},"password":{"type":"string"},"loginUrl":{"type":"string"}}},"message":{"type":"string"}}}}}},"400":{"description":"Bad request","content":{"application/json":{"schema":{"description":"Bad request","type":"object","properties":{"error":{"type":"string"},"message":{"type":"string"}}}}}}}}},"/api/internal/companies":{"get":{"summary":"List all companies","tags":["internal"],"description":"Retrieve a list of all registered companies in the system. Returns company details including name, status, and associated metadata.","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"List of companies retrieved successfully","content":{"application/json":{"schema":{"description":"List of companies retrieved successfully","type":"object","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"companies":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","description":"Unique identifier of the company (UUID)"},"name":{"type":"string","description":"Company name"},"email":{"type":"string","description":"Company contact email"},"phone":{"type":"string","nullable":true,"description":"Company phone number"},"address":{"type":"string","nullable":true,"description":"Company address"},"isActive":{"type":"boolean","description":"Whether the company is active"},"createdAt":{"type":"string","format":"date-time","description":"Timestamp when the company was created"},"updatedAt":{"type":"string","format":"date-time","description":"Timestamp when the company was last updated"}}},"description":"Array of company objects"},"total":{"type":"integer","description":"Total number of companies returned"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing authentication token","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authentication error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authorization error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Server error message"}}}}}}}},"post":{"summary":"Create a new company","tags":["internal"],"description":"Create a new company in the system. Companies are the top-level organizational unit that vendors and company managers are assigned to.","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["name"],"properties":{"name":{"type":"string","minLength":2,"description":"Company name, e.g. Acme Corporation"},"email":{"type":"string","format":"email","description":"Company contact email, e.g. contact@acme.com"},"phone":{"type":"string","nullable":true,"description":"Company phone number, e.g. +964-770-123-4567"},"address":{"type":"string","nullable":true,"description":"Company physical address"},"description":{"type":"string","nullable":true,"description":"Brief description of the company"}}}}},"required":true},"security":[{"bearerAuth":[]}],"responses":{"201":{"description":"Company created successfully","content":{"application/json":{"schema":{"description":"Company created successfully","type":"object","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"company":{"type":"object","properties":{"id":{"type":"string","description":"Unique identifier of the created company (UUID)"},"name":{"type":"string","description":"Company name"},"email":{"type":"string","description":"Company contact email"},"phone":{"type":"string","nullable":true,"description":"Company phone number"},"address":{"type":"string","nullable":true,"description":"Company address"},"isActive":{"type":"boolean","description":"Whether the company is active (defaults to true)"},"createdAt":{"type":"string","format":"date-time","description":"Timestamp when the company was created"},"updatedAt":{"type":"string","format":"date-time","description":"Timestamp when the company was last updated"}}},"message":{"type":"string","description":"Success message"}}}}}},"400":{"description":"Bad request - validation error or company name already exists","content":{"application/json":{"schema":{"description":"Bad request - validation error or company name already exists","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Detailed error message"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing authentication token","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authentication error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authorization error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Server error message"}}}}}}}}},"/api/internal/users":{"get":{"summary":"List all users","tags":["internal"],"description":"Retrieve a list of all users in the system. Optionally filter by role using query parameter.","parameters":[{"schema":{"type":"string","enum":["VENDOR","SHOP_OWNER","COMPANY_MANAGER","INTERNAL"]},"in":"query","name":"role","required":false,"description":"Filter users by role. Valid values: VENDOR, SHOP_OWNER, COMPANY_MANAGER, INTERNAL"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"List of users retrieved successfully","content":{"application/json":{"schema":{"description":"List of users retrieved successfully","type":"object","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"users":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","description":"Unique identifier of the user (UUID)"},"email":{"type":"string","description":"User email address"},"name":{"type":"string","description":"User full name"},"role":{"type":"string","description":"User role (VENDOR, SHOP_OWNER, COMPANY_MANAGER, INTERNAL)"},"phone":{"type":"string","nullable":true,"description":"User phone number"},"businessName":{"type":"string","nullable":true,"description":"Business name (for SHOP_OWNER)"},"zones":{"type":"array","items":{"type":"string"},"description":"Array of zones assigned to the user"},"companyId":{"type":"string","nullable":true,"description":"UUID of assigned company (for VENDOR and COMPANY_MANAGER)"},"isActive":{"type":"boolean","description":"Whether the user account is active"},"createdAt":{"type":"string","format":"date-time","description":"Timestamp when the user was created"},"updatedAt":{"type":"string","format":"date-time","description":"Timestamp when the user was last updated"}}},"description":"Array of user objects"},"total":{"type":"integer","description":"Total number of users returned"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing authentication token","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authentication error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authorization error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Server error message"}}}}}}}}},"/api/internal/users/{id}/deactivate":{"patch":{"summary":"Deactivate a user","tags":["internal"],"description":"Deactivate a user account by ID. Deactivated users cannot log in or access the system until reactivated.","parameters":[{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true,"description":"UUID of the user to deactivate"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"User deactivated successfully","content":{"application/json":{"schema":{"description":"User deactivated successfully","type":"object","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"message":{"type":"string","description":"Success message"}}}}}},"400":{"description":"Bad request - invalid user ID or user cannot be deactivated","content":{"application/json":{"schema":{"description":"Bad request - invalid user ID or user cannot be deactivated","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Detailed error message"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing authentication token","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authentication error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authorization error message"}}}}}},"404":{"description":"Not found - user with specified ID does not exist","content":{"application/json":{"schema":{"description":"Not found - user with specified ID does not exist","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Not found error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Server error message"}}}}}}}}},"/api/internal/users/{id}/activate":{"patch":{"summary":"Activate a user","tags":["internal"],"description":"Activate a previously deactivated user account by ID. Once activated, the user can log in and access the system again.","parameters":[{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true,"description":"UUID of the user to activate"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"User activated successfully","content":{"application/json":{"schema":{"description":"User activated successfully","type":"object","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"message":{"type":"string","description":"Success message"}}}}}},"400":{"description":"Bad request - invalid user ID or user cannot be activated","content":{"application/json":{"schema":{"description":"Bad request - invalid user ID or user cannot be activated","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Detailed error message"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing authentication token","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authentication error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authorization error message"}}}}}},"404":{"description":"Not found - user with specified ID does not exist","content":{"application/json":{"schema":{"description":"Not found - user with specified ID does not exist","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Not found error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Server error message"}}}}}}}}},"/api/internal/generate-password":{"get":{"summary":"Generate a secure password","tags":["internal"],"description":"Generate a cryptographically secure random password. Useful for creating user accounts with auto-generated passwords.","parameters":[{"schema":{"type":"integer","minimum":8,"maximum":32,"default":12},"in":"query","name":"length","required":false,"description":"Length of the generated password. Defaults to 12 characters. Valid range: 8-32"}],"security":[{"bearerAuth":[]}],"responses":{"200":{"description":"Password generated successfully","content":{"application/json":{"schema":{"description":"Password generated successfully","type":"object","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"password":{"type":"string","description":"The generated password"},"message":{"type":"string","description":"Success message"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing authentication token","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authentication error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authorization error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Server error message"}}}}}}}}},"/api/internal/zones":{"get":{"summary":"Get available zones","tags":["internal"],"description":"Retrieve a list of all available geographic zones in the system. Zones are used to assign vendors and shop owners to specific areas.","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"List of available zones retrieved successfully","content":{"application/json":{"schema":{"description":"List of available zones retrieved successfully","type":"object","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"zones":{"type":"array","items":{"type":"string","enum":["KARKH","RUSAFA","SADR_CITY","KADHMIYA","ADHAMIYA","MANSOUR","ZAFARANIYA","KARRADA","NEW_BAGHDAD","AL_RASHID"]},"description":"Array of available zone identifiers"},"message":{"type":"string","description":"Informational message"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing authentication token","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authentication error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authorization error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Server error message"}}}}}}}}},"/api/internal/roles":{"get":{"summary":"Get available roles","tags":["internal"],"description":"Retrieve a list of all available user roles in the system, categorized by platform (dashboard or mobile). Use this to determine which roles can be assigned when creating new users.","security":[{"bearerAuth":[]}],"responses":{"200":{"description":"List of available roles retrieved successfully","content":{"application/json":{"schema":{"description":"List of available roles retrieved successfully","type":"object","properties":{"success":{"type":"boolean","description":"Indicates if the operation was successful"},"roles":{"type":"object","properties":{"dashboard":{"type":"array","items":{"type":"string","enum":["VENDOR","COMPANY_MANAGER"]},"description":"Roles that can access the web dashboard"},"mobile":{"type":"array","items":{"type":"string","enum":["SHOP_OWNER"]},"description":"Roles that can access the mobile app"}},"description":"Object containing roles grouped by platform"},"message":{"type":"string","description":"Informational message"}}}}}},"401":{"description":"Unauthorized - invalid or missing authentication token","content":{"application/json":{"schema":{"description":"Unauthorized - invalid or missing authentication token","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authentication error message"}}}}}},"403":{"description":"Forbidden - insufficient permissions","content":{"application/json":{"schema":{"description":"Forbidden - insufficient permissions","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Authorization error message"}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"description":"Internal server error","type":"object","properties":{"error":{"type":"string","description":"Error type identifier"},"message":{"type":"string","description":"Server error message"}}}}}}}}}},"servers":[{"url":"http://localhost:3000","description":"Development server"}],"tags":[{"name":"health","description":"Health check endpoints"},{"name":"auth","description":"Authentication endpoints"},{"name":"users","description":"User management endpoints"},{"name":"products","description":"Product management endpoints"},{"name":"categories","description":"Category management endpoints"},{"name":"orders","description":"Order management endpoints"},{"name":"promotions","description":"Promotion management endpoints"},{"name":"companies","description":"Company management endpoints"},{"name":"vendors","description":"Vendor operations endpoints"},{"name":"cart","description":"Shopping cart endpoints"},{"name":"delivery","description":"Delivery and fulfillment endpoints"},{"name":"settlements","description":"Settlement management endpoints"},{"name":"analytics","description":"Analytics and reporting endpoints"},{"name":"payouts","description":"Payout management endpoints"},{"name":"upload","description":"File upload endpoints"},{"name":"internal","description":"Internal system endpoints"}]}
